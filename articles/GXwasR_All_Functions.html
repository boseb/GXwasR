<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>GXwasR Functions • GXwasR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GXwasR Functions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GXwasR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/GXwasR_All_Functions.html">GXwasR Functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>GXwasR Functions</h1>
                        <h4 data-toc-skip class="author">Banabithi Bose,
Northwestern University</h4>
            
      

      <div class="d-none name"><code>GXwasR_All_Functions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="gxwasr-description">
<a id="GXwasR Description"></a> GXwasR Description:<a class="anchor" aria-label="anchor" href="#gxwasr-description"></a>
</h2>
<p>This package implements various statistical genetics models for
Genome-Wide Association (GWA) and X-Chromosome Wide Association (XWA)
analyses in a sex-combined or sex-stratified way considering
X-Chromosome Inactivation (XCI) pattern. In addition to association
analysis, the package also enables testing for sex differences in
genetic effects, including the implementation of specific models and
applying best practices for additional quality control (QC) of genetic
data required for these tests. The package includes thirty different
functions in six different categories (A-F) which enable a comprehensive
pipeline for sex-aware genetic association analysis of common variants
with unrelated individuals.</p>
</div>
<div class="section level2">
<h2 id="functions-overview">Functions Overview<a class="anchor" aria-label="anchor" href="#functions-overview"></a>
</h2>
<p>This document lists all the functions in GXwasR package.It offers
thirty-three distinct functions, which are organized into six main
categories: A) Pre-imputation QC, B) Post-imputation QC, C) Sex-combined
and sex-stratified GWAS with specialized analysis for XWAS, D)
Sex-differential test, E) High level analysis and a range of F) Utility
Functions. These categories and their respective functions are detailed
in the below Table.</p>
<div class="section level3">
<h3 id="table-of-functions">Table of Functions<a class="anchor" aria-label="anchor" href="#table-of-functions"></a>
</h3>
<table class="table">
<colgroup>
<col width="10%">
<col width="67%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
<th>Category</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>QCsnp()</td>
<td>Performs quality control for SNPs in PLINK binary files.</td>
<td>Pre-imputation QC, Post-imputation QC</td>
</tr>
<tr class="even">
<td>QCsample()</td>
<td>Identifies outlier individuals based on heterozygosity and missing
genotype rates.</td>
<td>Pre-imputation QC, Post-imputation QC</td>
</tr>
<tr class="odd">
<td>AncestryCheck()</td>
<td>Evaluates samples’ ancestry and flags outliers using PCA.</td>
<td>Pre-imputation QC</td>
</tr>
<tr class="even">
<td>SexCheck()</td>
<td>Compares sex assignments with predictions from X chromosome
inbreeding coefficients.</td>
<td>Pre-imputation QC</td>
</tr>
<tr class="odd">
<td>Xhwe()</td>
<td>Filters X-chromosome variants violating Hardy-Weinberg Equilibrium
in females.</td>
<td>Post-imputation QC</td>
</tr>
<tr class="even">
<td>MAFdiffSexControl()</td>
<td>Tests for significant MAF differences between sexes in control
samples.</td>
<td>Post-imputation QC</td>
</tr>
<tr class="odd">
<td>FilterRegion()</td>
<td>Filters out specific chromosomal regions from input PLINK
files.</td>
<td>Post-imputation QC, Utility Functions</td>
</tr>
<tr class="even">
<td>GXwas()</td>
<td>Runs GWAS models in autosomes with XWAS models like “FMcomb01”,
“FMcomb02”, “FMstratified” for binary and quantitative traits, and
“GWAScxci” for binary traits. Focuses on additive SNP effects,
multi-collinearity issues, and includes multiple covariates and their
interactions.</td>
<td>Sex-combined and sex-stratified GWAS with XWAS</td>
</tr>
<tr class="odd">
<td>PvalComb()</td>
<td>Combines p-values from separate GWAS using various statistical
methods and corrects summary p-values.</td>
<td>Sex-combined and sex-stratified GWAS with XWAS</td>
</tr>
<tr class="even">
<td>SexDiff()</td>
<td>Evaluates sex differences in genetic effect size for each SNP.</td>
<td>Sex-differential test</td>
</tr>
<tr class="odd">
<td>SexDiffZscore()</td>
<td>Presumably analyzes sex differences using Z-score methodology,
comparing genetic effect sizes between males and females.</td>
<td>Sex-differential test</td>
</tr>
<tr class="even">
<td>DiffZeroOne()</td>
<td>Assesses Z-scores for deviation from one and zero for statistics
like genetic correlation.</td>
<td>Sex-differential test</td>
</tr>
<tr class="odd">
<td>TestXGene()</td>
<td>Performs gene-based association tests using GWAS/XWAS summary
statistics.</td>
<td>High level analysis</td>
</tr>
<tr class="even">
<td>MetaGXwas()</td>
<td>Combines summary-level GWAS results using fixed-effect and
random-effect models.</td>
<td>High level analysis</td>
</tr>
<tr class="odd">
<td>ComputePRS()</td>
<td>Calculates polygenic risk scores from GWAS summary statistics.</td>
<td>High level analysis</td>
</tr>
<tr class="even">
<td>GeneticCorrBT()</td>
<td>Computes genetic correlation between to traits.</td>
<td>High level analysis</td>
</tr>
<tr class="odd">
<td>EstimateHerit()</td>
<td>Computes SNP heritability using GREML or LDSC models.</td>
<td>High level analysis</td>
</tr>
<tr class="even">
<td>SexRegress()</td>
<td>Not previously described. Presumably involves regression analyses
specific to sex-stratified data.</td>
<td>High level analysis</td>
</tr>
<tr class="odd">
<td>FilterPlinkSample()</td>
<td>Prepares PLINK binary files with desired samples based on specified
criteria.</td>
<td>Utility Functions</td>
</tr>
<tr class="even">
<td>ComputeGeneticPC()</td>
<td>Computes principal components from a genetic relationship matrix for
population stratification correction.</td>
<td>Utility Functions</td>
</tr>
<tr class="odd">
<td>ClumpLD()</td>
<td>Performs linkage disequilibrium clumping of SNPs.</td>
<td>Utility Functions</td>
</tr>
<tr class="even">
<td>GetMFPlink()</td>
<td>Prepares separate male and female PLINK binary files from combined
files.</td>
<td>Utility Functions</td>
</tr>
<tr class="odd">
<td>plinkVCF()</td>
<td>Converts VCF files to plink binary formats and vice versa, including
creation of dummy FAM files.</td>
<td>Utility Functions</td>
</tr>
<tr class="even">
<td>MergeRegion()</td>
<td>Combines two genotype datasets based on common or all SNPs.</td>
<td>Utility Functions</td>
</tr>
<tr class="odd">
<td>FilterAllele()</td>
<td>Filters out multi-allelic variants from the genetic dataset,
essential for maintaining dataset integrity and simplifying genetic
analyses.</td>
<td>Utility Functions</td>
</tr>
<tr class="even">
<td>PlinkSummary()</td>
<td>Provides a summary of genotype datasets in plink format.</td>
<td>Utility Functions</td>
</tr>
<tr class="odd">
<td>FilterSNP()</td>
<td>Filters out specific SNPs from the dataset based on user-defined
criteria.</td>
<td>Utility Functions</td>
</tr>
<tr class="even">
<td>DummyCovar()</td>
<td>Recodes a categorical covariate into binary dummy variables for
statistical analysis in GXwasR.</td>
<td>Utility Functions</td>
</tr>
<tr class="odd">
<td>GXWASmiami()</td>
<td>Generates Miami plots for GWAS and XWAS.</td>
<td></td>
</tr>
<tr class="even">
<td>Utility Functions</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Download_reference()</td>
<td>Download Hapmap phase 3 and 1000 Genome phase 3 Data.</td>
<td></td>
</tr>
<tr class="even">
<td>Utility Functions</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>SumstatGenCorr()</td>
<td>Genetic Correlation Calculation from GWAS Summary Statistics.</td>
<td></td>
</tr>
<tr class="even">
<td>High level analysis</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>LDPrune()</td>
<td>Performs LD pruning on SNP data.</td>
<td></td>
</tr>
<tr class="even">
<td>Utility Functions</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>executePlinkMAF()</td>
<td>Calculate minor allele frequencies.</td>
<td></td>
</tr>
<tr class="even">
<td>Utility Functions</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>ComputeLD()</td>
<td>Calculate LD matrix.</td>
<td></td>
</tr>
<tr class="even">
<td>Utility Functions</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GXwasR</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## GXwasR: Genome-wide and x-chromosome wide association analyses applying</span></span>
<span><span class="co">## best practices of quality control over genetic data</span></span></code></pre>
<pre><code><span><span class="co">## Version 0.99.0 () installed</span></span></code></pre>
<pre><code><span><span class="co">## Author: c(</span></span>
<span><span class="co">##     person(given = "Banabithi",</span></span>
<span><span class="co">##            family = "Bose",</span></span>
<span><span class="co">##            role = c("cre", "aut"),</span></span>
<span><span class="co">##            email = "banabithi.bose@gmail.com",</span></span>
<span><span class="co">##            comment = c(ORCID = "0000-0003-0842-8768"))</span></span>
<span><span class="co">##            )</span></span></code></pre>
<pre><code><span><span class="co">## Maintainer: Banabithi Bose &lt;banabithi.bose@gmail.com&gt;</span></span></code></pre>
<pre><code><span><span class="co">## Tutorial: https://github.com</span></span></code></pre>
<pre><code><span><span class="co">## Use citation("GXwasR") to know how to cite this work.</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/printr/" class="external-link">printr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Registered S3 method overwritten by 'printr':</span></span>
<span><span class="co">##   method                from     </span></span>
<span><span class="co">##   knit_print.data.frame rmarkdown</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown" class="external-link">rmarkdown</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="function-1">Function 1<a class="anchor" aria-label="anchor" href="#function-1"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">QCsnp</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>QCsnp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>QCsnp: Quality control (QC) for SNPs.</h3>

<h4>Description</h4>

<p>This function performs quality control on genetic variant data from PLINK binary files. It filters variants based on parameters
like minor allele frequency, Hardy-Weinberg equilibrium, call rate, and differential missingness between cases and controls.
It also handles monomorphic SNPs and applies linkage disequilibrium-based filtering if specified.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/QCsnp.html">QCsnp</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  foutput <span class="op">=</span> <span class="st">"FALSE"</span>,</span>
<span>  casecontrol <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hweCase <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hweControl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hwe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maf <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  geno <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  monomorphicSNPs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  caldiffmiss <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  diffmissFilter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dmissX <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dmissAutoY <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  highLD_regions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ld_prunning <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  step_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  r2_threshold <span class="op">=</span> <span class="fl">0.02</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files with both male and female samples. This file needs
to be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output PLINK binary files if the filtering option for the SNPs is chosen.
The default is "FALSE".</p>
</td>
</tr>
<tr>
<td><code id="casecontrol">casecontrol</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> indicating if the input plink files has cases-control status or not.
The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="hweCase">hweCase</code></td>
<td>
<p>Numeric value between 0 to 1 or <code>NULL</code> for removing SNPs which fail Hardy-Weinberg equilibrium for cases.
The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="hweControl">hweControl</code></td>
<td>
<p>Numeric value between 0 to 1 or <code>NULL</code> for removing SNPs which fail Hardy-Weinberg equilibrium for controls.
The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="hwe">hwe</code></td>
<td>
<p>Numeric value between 0 to 1 or <code>NULL</code> for removing SNPs which fail Hardy-Weinberg equilibrium for entire dataset.
The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="maf">maf</code></td>
<td>
<p>Numeric value between 0 to 1 for removing SNPs with minor allele frequency less than the specified threshold.
The default is 0.05.</p>
</td>
</tr>
<tr>
<td><code id="geno">geno</code></td>
<td>
<p>Numeric value between 0 to 1 for removing SNPs that have less than the specified call rate. The default is 0.05.
</p>
<p>Users can set this as <code>NULL</code> to not apply this filter.</p>
</td>
</tr>
<tr>
<td><code id="monomorphicSNPs">monomorphicSNPs</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for filtering out monomorphic SNP. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="caldiffmiss">caldiffmiss</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to compute differential missingness between cases and controls
for each SNP (threshold is <code class="reqn">0.05/length(unique(No. of. SNPs in the test))</code>). The default is <code>TRUE.</code></p>
</td>
</tr>
<tr>
<td><code id="diffmissFilter">diffmissFilter</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to filter out the SNPs or only flagged them for differential
missingness in cases vs contols. The deafailt is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="dmissX">dmissX</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for computing differential missingness between cases and controls for X chromosome
SNPs only. The default is <code>FALSE</code>. The diffmissFilter will work for all these SNPs.</p>
</td>
</tr>
<tr>
<td><code id="dmissAutoY">dmissAutoY</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for computing differential missingness between cases and controls for SNPs on autosomes
and Y chromosome only. The default is <code>FALSE</code>.
</p>
<p>If <code>dmissX</code> and <code>dmissAutoY</code> are both <code>FALSE</code>, then this will be computed genome-wide. The <code>diffmissFilter</code> will work
for all these SNPs.</p>
</td>
</tr>
<tr>
<td><code id="highLD_regions">highLD_regions</code></td>
<td>
<p>A dataframe with known high LD regions (Anderson et al. 2010) is provided with the package.</p>
</td>
</tr>
<tr>
<td><code id="ld_prunning">ld_prunning</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for applying linkage disequilibrium (LD)-based filtering.</p>
</td>
</tr>
<tr>
<td><code id="window_size">window_size</code></td>
<td>
<p>Integer value, specifying a window size in the variant counts for LD-based filtering. The default is 50.</p>
</td>
</tr>
<tr>
<td><code id="step_size">step_size</code></td>
<td>
<p>Integer value, specifying a variant count to shift the window at the end of each step for LD filtering. The default is 5.</p>
</td>
</tr>
<tr>
<td><code id="r2_threshold">r2_threshold</code></td>
<td>
<p>Numeric value between 0 to 1 of pairwise <code class="reqn">r^2</code> threshold for LD-based filtering. The default is 0.02.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A list of two objects, namely, <code>MonomorSNPs</code> and <code>DiffMissSNPs</code> containing monomorphic SNPs and SNPs with differential missingness
in cases vs controls, respectively. Output plink binary files in the working directory.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>References</h4>

<p>Anderson CA, Pettersson FH, Clarke GM, Cardon LR, Morris AP, Zondervan KT (2010).
“Data quality control in genetic case-control association studies.”
<em>Nature Protocols</em>, <b>5</b>(9), 1564–1573.
<a href="https://doi.org/10.1038/nprot.2010.116" class="external-link">doi:10.1038/nprot.2010.116</a>, <a href="http://www.ncbi.nlm.nih.gov/pubmed/21085122" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/21085122</a>.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"Test_output"</span></span>
<span><span class="va">geno</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">maf</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">casecontrol</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">hweCase</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">hweControl</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">hweCase</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">monomorphicSNPs</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">caldiffmiss</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">ld_prunning</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/QCsnp.html">QCsnp</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>, finput <span class="op">=</span> <span class="va">finput</span>, foutput <span class="op">=</span> <span class="va">foutput</span>,</span>
<span>    geno <span class="op">=</span> <span class="va">geno</span>, maf <span class="op">=</span> <span class="va">maf</span>, hweCase <span class="op">=</span> <span class="va">hweCase</span>, hweControl <span class="op">=</span> <span class="va">hweControl</span>,</span>
<span>    ld_prunning <span class="op">=</span> <span class="va">ld_prunning</span>, casecontrol <span class="op">=</span> <span class="va">casecontrol</span>, monomorphicSNPs <span class="op">=</span> <span class="va">monomorphicSNPs</span>,</span>
<span>    caldiffmiss <span class="op">=</span> <span class="va">caldiffmiss</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-2">Function 2<a class="anchor" aria-label="anchor" href="#function-2"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">QCsample</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>QCsample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>QCsample: Quality control for samples in the plink binary files.</h3>

<h4>Description</h4>

<p>This function identifies outlier individuals for heterozygosity and/or missing genotype rates, which aids in the
detection of samples with subpar DNA quality and/or concentration that should be removed from the study. Individuals
missing more than 3-7% of their genotype calls are often excluded from the analysis.
</p>
<p>Having the correct designation of sex is important to obtain accurate genotype rate estimates, or avoid incorrectly
removing samples, etc. Details can be accessed from the paper.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/QCsample.html">QCsample</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  <span class="va">ResultDir</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  foutput <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">imiss</span>,</span>
<span>  <span class="va">het</span>,</span>
<span>  small_sample_mod <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">IBD</span>,</span>
<span>  IBDmatrix <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ambi_out <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend_text_size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  legend_title_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  axis_text_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  axis_title_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  title_size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  filterSample <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>Character string, specifying the file path of the input PLINK binary files. The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files with both male and female samples.
This file needs to be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output PLINK binary files if filtering option for the samples is chosen.</p>
</td>
</tr>
<tr>
<td><code id="imiss">imiss</code></td>
<td>
<p>Numeric value between 0 to 1 for removing samples that have more than the specified missingness. The default is 0.03.</p>
</td>
</tr>
<tr>
<td><code id="het">het</code></td>
<td>
<p>Positive numeric value, specifying the standard deviation from the mean heterozygosity rate. The samples whose rates are more
than the specified sd from the mean heterozygosity rate are removed. The default is 3. With this default value, outlying
heterozygosity rates would remove individuals who are three sd away from the mean rate (1).</p>
</td>
</tr>
<tr>
<td><code id="small_sample_mod">small_sample_mod</code></td>
<td>
<p>Boolean value indicating whether to apply modifications for small sample sizes. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="IBD">IBD</code></td>
<td>
<p>Numeric value for setting the threshold for Identity by Descent (IBD) analysis. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="IBDmatrix">IBDmatrix</code></td>
<td>
<p>Boolean value indicating whether to generate an entire IBD matrix. Default is <code>FALSE</code>. In this case filtered IBD
matrix will be stored.</p>
</td>
</tr>
<tr>
<td><code id="ambi_out">ambi_out</code></td>
<td>
<p>Boolean value indicating whether to process ambiguous samples.</p>
</td>
</tr>
<tr>
<td><code id="legend_text_size">legend_text_size</code></td>
<td>
<p>Integer, specifying the size for legend text in the plot.</p>
</td>
</tr>
<tr>
<td><code id="legend_title_size">legend_title_size</code></td>
<td>
<p>Integer, specifying the size for the legend title in the plot.</p>
</td>
</tr>
<tr>
<td><code id="axis_text_size">axis_text_size</code></td>
<td>
<p>Integer, specifying the size for axis text in the plot.</p>
</td>
</tr>
<tr>
<td><code id="axis_title_size">axis_title_size</code></td>
<td>
<p>Integer, specifying the size for the axis title in the plot.</p>
</td>
</tr>
<tr>
<td><code id="title_size">title_size</code></td>
<td>
<p>Integer, specifying the size of the title of the plot heterozygosity estimate vs missingness across samples.</p>
</td>
</tr>
<tr>
<td><code id="filterSample">filterSample</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for filtering out the samples or not (i.e., only flagged). The default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A plot of heterogysity estimate vs missingness accross sample and a list containing five R dataframe objects, namely,
<code>HM</code> (samples with outlying heterozygosity and/or missing genotype rates), <code>Failed_Missingness</code> (samples with missing genotype rates),
<code>Failed_heterozygosity</code> (samples with outlying heterozygosity), <code>Missingness_results</code> (missingness results) and <code>Heterozygosity_results</code>
(heterozygosity results) with output plink files in ResultDir if filtering out the samples option is chosen.
</p>
<p><code>Missingness_results</code> contains missingness results for each individual, with six columns as <code>FID</code>, <code>IID</code>, <code>MISS_PHENO</code>, <code>N_MISS</code>, <code>N_GENO</code> and
<code>F_MISS</code> for Family ID, Within-family ID, Phenotype missing? (Y/N), Number of missing genotype call(s), not including obligatory missings
or heterozygous haploids, number of potentially valid call(s), and missing call rate, respectively.
</p>
<p><code>Heterozygosity_results</code> contains heterozygosity results for each individual, with six columns as <code>FID</code>, <code>IID</code>, <code>O(HOM)</code>, <code>E(HOM)</code>, <code>N(NM)</code>,
and <code>F</code> for Family ID, Within-family ID, Observed number of homozygotes, Expected number of homozygotes, Number of (non-missing, non-monomorphic)
autosomal genotype observations and, Method-of-moments F coefficient estimate, respectively.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"Test_output"</span></span>
<span><span class="va">imiss</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">het</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">small_sample_mod</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">IBDmatrix</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">ambi_out</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/QCsample.html">QCsample</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>, finput <span class="op">=</span> <span class="va">finput</span>,</span>
<span>    foutput <span class="op">=</span> <span class="va">foutput</span>, imiss <span class="op">=</span> <span class="va">imiss</span>, het <span class="op">=</span> <span class="va">het</span>, IBD <span class="op">=</span> <span class="va">IBD</span>,</span>
<span>    ambi_out <span class="op">=</span> <span class="va">ambi_out</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-3">Function 3<a class="anchor" aria-label="anchor" href="#function-3"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">AncestryCheck</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>AncestryCheck</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>AncestryCheck: Evaluation of the samples' ancestry label.</h3>

<h4>Description</h4>

<p>This function displays the result of the ancestry analysis in a color-coded scatter plot of the first two principal
components for samples of the reference populations and the study population. Specifically, it compares the study samples'
ancestry labels to a panel representing a reference population, and it also flags the outlier samples with respect to a
chosen reference population.
</p>
<p>The function first filters the reference and study data for non-A-T or G-C SNPs. It next conducts
LD pruning, fixes the chromosome mismatch between the reference and study datasets, checks for allele flips, updates the
locations, and flips the alleles. The two datasets are then joined, and the resulting genotype dataset is subjected to Principal
Component Analysis (PCA).
</p>
<p>The detection of population structure down to the level of the reference dataset can then be accomplished
using PCA on this combined genotyping panel. For instance, the center of the European reference samples is determined using the
data from principal components 1 and 2 (median(PC1 europeanRef), median(PC2 europeanRef)). It determines the European reference
samples' maximum Euclidean distance (maxDist) from this center.
</p>
<p>All study samples that are non-European, or outliers, are those whose Euclidean distances from the center are more than or
equal to the radius r= outlier threshold* maxDist. This function utilizes the HapMap phase 3 data in NCBI 36 and 1000GenomeIII
in CGRCh37. Both study and reference datasets should be of the same genome build. If not, users need to lift over one of the
datasets to the same build.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/AncestryCheck.html">AncestryCheck</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HapMapIII_NCBI36"</span>, <span class="st">"ThousandGenome"</span><span class="op">)</span>,</span>
<span>  filterSNP <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  studyLD <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  studyLD_window_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  studyLD_step_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  studyLD_r2_threshold <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  referLD <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  referLD_window_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  referLD_step_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  referLD_r2_threshold <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  <span class="va">highLD_regions</span>,</span>
<span>  <span class="va">study_pop</span>,</span>
<span>  outlier <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  outlierOf <span class="op">=</span> <span class="st">"EUR"</span>,</span>
<span>  outlier_threshold <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files for the study samples.</p>
</td>
</tr>
<tr>
<td><code id="reference">reference</code></td>
<td>
<p>Boolean value,'HapMapIII_NCBI36' and 'ThousandGenome', specifying Hapmap Phase3 (3 Consortium 2010) and 1000 Genomes
phase III (1000 Genomes Project Consortium 2015) reference population, respectively. The default is 'HapMapIII_NCBI36'.</p>
</td>
</tr>
<tr>
<td><code id="filterSNP">filterSNP</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for filtering out the SNPs. The default is <code>TRUE</code>. We recommend setting it <code>FALSE</code>
only when the users are sure that they could join the study and reference samples directly.</p>
</td>
</tr>
<tr>
<td><code id="studyLD">studyLD</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for applying linkage disequilibrium (LD)-based filtering on study genotype data.</p>
</td>
</tr>
<tr>
<td><code id="studyLD_window_size">studyLD_window_size</code></td>
<td>
<p>Integer value, specifying a window size in variant count or kilobase for LD-based filtering of the variants for the study data.</p>
</td>
</tr>
<tr>
<td><code id="studyLD_step_size">studyLD_step_size</code></td>
<td>
<p>Integer value, specifying a variant count to shift the window at the end of each step for LD filtering for the study data.</p>
</td>
</tr>
<tr>
<td><code id="studyLD_r2_threshold">studyLD_r2_threshold</code></td>
<td>
<p>Numeric value between 0 to 1 of pairwise <code class="reqn">r^2</code> threshold for LD-based filtering for the study data.</p>
</td>
</tr>
<tr>
<td><code id="referLD">referLD</code></td>
<td>
<p>Boolean value, 'TRUE' or 'FALSE' for applying linkage disequilibrium (LD)-based filtering on reference genotype data.</p>
</td>
</tr>
<tr>
<td><code id="referLD_window_size">referLD_window_size</code></td>
<td>
<p>Integer value, specifying a window size in variant count or kilobase for LD-based filtering of the variants for the reference data.</p>
</td>
</tr>
<tr>
<td><code id="referLD_step_size">referLD_step_size</code></td>
<td>
<p>Integer value, specifying a variant count to shift the window at the end of each step for LD filtering for the reference data.</p>
</td>
</tr>
<tr>
<td><code id="referLD_r2_threshold">referLD_r2_threshold</code></td>
<td>
<p>Numeric value between 0 to 1 of pairwise <code class="reqn">r^2</code> threshold for LD-based filtering for the reference data.</p>
</td>
</tr>
<tr>
<td><code id="highLD_regions">highLD_regions</code></td>
<td>
<p>A dataframe with known high LD regions (Anderson et al. 2010) is provided with the package.</p>
</td>
</tr>
<tr>
<td><code id="study_pop">study_pop</code></td>
<td>
<p>A dataframe containing two columns for study in first column, sample ID (i.e., IID) and in second column, the ancestry label.</p>
</td>
</tr>
<tr>
<td><code id="outlier">outlier</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying outlier detection will be performed or not.</p>
</td>
</tr>
<tr>
<td><code id="outlierOf">outlierOf</code></td>
<td>
<p>Chracter string, specifying the reference ancestry name for detecting outlier samples. The default is "outlierOf = "EUR".</p>
</td>
</tr>
<tr>
<td><code id="outlier_threshold">outlier_threshold</code></td>
<td>
<p>Numeric value, specifying the threshold to be be used to detect outlier samples. This threshold will be multiplied with the
Eucledean distance from the center of the PC 1 and PC2 to the maximum Euclidean distance of the reference samples. Study samples
outside this distance will be considered as outlier. The default is 3.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A dataframe with the IDs of non-European samples as outliers.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>References</h4>

<p>1000 Genomes Project Consortium T (2015).
“A global reference for human genetic variation.”
<em>Nature</em>, <b>526</b>, 68–74.
<a href="https://doi.org/10.1038/nature15393" class="external-link">doi:10.1038/nature15393</a>.<br><br> 3 Consortium TIH (2010).
“Integrating common and rare genetic variation in diverse human populations.”
<em>Nature</em>, <b>467</b>, 52–58.
<a href="https://doi.org/10.1038/nature09298" class="external-link">doi:10.1038/nature09298</a>.<br><br> Anderson CA, Pettersson FH, Clarke GM, Cardon LR, Morris AP, Zondervan KT (2010).
“Data quality control in genetic case-control association studies.”
<em>Nature Protocols</em>, <b>5</b>(9), 1564–1573.
<a href="https://doi.org/10.1038/nprot.2010.116" class="external-link">doi:10.1038/nprot.2010.116</a>, <a href="http://www.ncbi.nlm.nih.gov/pubmed/21085122" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/21085122</a>.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"highLD_hg19"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_data_study_sample_ancestry"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">reference</span> <span class="op">&lt;-</span> <span class="st">"HapMapIII_NCBI36"</span></span>
<span><span class="va">highLD_regions</span> <span class="op">&lt;-</span> <span class="va">highLD_hg19</span></span>
<span><span class="va">study_pop</span> <span class="op">&lt;-</span> <span class="va">example_data_study_sample_ancestry</span> <span class="co"># PreimputeEX</span></span>
<span><span class="va">studyLD_window_size</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">studyLD_step_size</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">studyLD_r2_threshold</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span><span class="va">filterSNP</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">studyLD</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">referLD</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">referLD_window_size</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">referLD_step_size</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">referLD_r2_threshold</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span><span class="va">outlier</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">outlier_threshold</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AncestryCheck.html">AncestryCheck</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>, finput <span class="op">=</span> <span class="va">finput</span>,</span>
<span>    reference <span class="op">=</span> <span class="st">"HapMapIII_NCBI36"</span>, highLD_regions <span class="op">=</span> <span class="va">highLD_regions</span>,</span>
<span>    study_pop <span class="op">=</span> <span class="va">study_pop</span>, studyLD <span class="op">=</span> <span class="va">studyLD</span>, referLD <span class="op">=</span> <span class="va">referLD</span>,</span>
<span>    outlierOf <span class="op">=</span> <span class="st">"EUR"</span>, outlier <span class="op">=</span> <span class="va">outlier</span>, outlier_threshold <span class="op">=</span> <span class="va">outlier_threshold</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-4">Function 4<a class="anchor" aria-label="anchor" href="#function-4"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">SexCheck</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>SexCheck</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>SexCheck: Compare sex assignments in the input plink files with those imputed from X chromosome inbreeding coefficients</h3>

<h4>Description</h4>

<p>This function compares sex assignments in the input dataset with those predicted from X chromosome inbreeding coefficients (Purcell et al. 2007),
and gives the option to convert the sex assignments to the predicted values. Implicitly, this function computes observed and expected autosomal homozygous
genotype counts for each sample and reports method-of-moments F coefficient estimates (i.e., observed hom. <code class="reqn">count - expected count) / (total observations - expected count)</code>).
The expected counts will be based on loaded or imputed minor allele frequencies.  Since imputed MAFs are highly inaccurate when there are few samples,
the 'compute freq' parameter should be set to TRUE to compute MAF implicitly.
</p>
<p>Due to the use of allele frequencies, if a cohort is comprised of individuals of different ancestries, users may need to process any samples with rare
ancestry individually if the dataset has a very unbalanced ancestry distribution. It is advised to run this function with all the parameters set to zero,
then examine the distribution of the F estimates (there should be a clear gap between a very tight male clump on the right side of the distribution and the
females everywhere else). Then, rerun the function with the parameters that correspond to this gap.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/SexCheck.html">SexCheck</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  impute_sex <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  compute_freq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  LD <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  LD_window_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  LD_step_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  LD_r2_threshold <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  fmax_F <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  mmin_F <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>Character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files. Note: Input dataset should contain X and Y regions.</p>
</td>
</tr>
<tr>
<td><code id="impute_sex">impute_sex</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying sex to be imputed or not. If <code>TRUE</code> then sex-imputed PLINK files, prefixed, 'seximputed_plink', will
be produced in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="compute_freq">compute_freq</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying minor allele frequency (MAF). This function requires reasonable MAF estimates, so it is essential
to use <code>compute_freq</code> = <code>TRUE</code> for computing MAF from an input PLINK file if there are very few samples in the input dataset. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="LD">LD</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for applying linkage disequilibrium (LD)-based filtering. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="LD_window_size">LD_window_size</code></td>
<td>
<p>Integer value, specifying a window size in variant count for LD-based filtering. The default is 50.</p>
</td>
</tr>
<tr>
<td><code id="LD_step_size">LD_step_size</code></td>
<td>
<p>Integer value, specifying a variant count to shift the window at the end of each step for LD filtering. The default is 5.</p>
</td>
</tr>
<tr>
<td><code id="LD_r2_threshold">LD_r2_threshold</code></td>
<td>
<p>Numeric value between 0 to 1 of pairwise <code class="reqn">r^2</code> threshold for LD-based filtering. The default is 0.02.</p>
</td>
</tr>
<tr>
<td><code id="fmax_F">fmax_F</code></td>
<td>
<p>Numeric value between 0 to 1. Samples with F estimates smaller than this value will be labeled as females. The default is 0.2.</p>
</td>
</tr>
<tr>
<td><code id="mmin_F">mmin_F</code></td>
<td>
<p>Numeric value between 0 to 1. Samples with F estimates larger than this value will be labeled as males. The default is 0.8.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A dataframe with six columns:
</p>

<ul>
<li> <p><code>FID</code> (Family ID)
</p>
</li>
<li> <p><code>IID</code> (Individual ID)
</p>
</li>
<li> <p><code>PEDSEX </code>(Sex as determined in pedigree file (1=male, 2=female))
</p>
</li>
<li> <p><code>SNPSEX</code> (Sex as determined by X chromosome)
</p>
</li>
<li> <p><code>STATUS</code> (Displays "PROBLEM" or "OK" for each individual)
</p>
</li>
<li> <p><code>F</code> (The actual X chromosome inbreeding (homozygosity) estimate)
</p>
</li>
</ul>
<p>A PROBLEM arises if the two sexes do not match, or if the SNP data or pedigree data are ambiguous with regard to sex.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>References</h4>

<p>Purcell S, Neale B, Todd-Brown K, Thomas L, Ferreira MAR, Bender D, Maller J, Sklar P, de Bakker PIW, Daly MJ, others (2007).
“PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses.”
<em>The American Journal of Human Genetics</em>, <b>81</b>(3), 559–575.
<a href="https://doi.org/10.1086/519795" class="external-link">doi:10.1086/519795</a>.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">LD</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">LD_window_size</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">LD_step_size</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">LD_r2_threshold</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span><span class="va">fmax_F</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">mmin_F</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="va">impute_sex</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">compute_freq</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SexCheck.html">SexCheck</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>, finput <span class="op">=</span> <span class="va">finput</span>, impute_sex <span class="op">=</span> <span class="va">impute_sex</span>,</span>
<span>    compute_freq <span class="op">=</span> <span class="va">compute_freq</span>, LD_window_size <span class="op">=</span> <span class="va">LD_window_size</span>, LD_step_size <span class="op">=</span> <span class="va">LD_step_size</span>,</span>
<span>    LD_r2_threshold <span class="op">=</span> <span class="fl">0.02</span>, fmax_F <span class="op">=</span> <span class="fl">0.2</span>, mmin_F <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Checking if there is any wrong sex assignment</span></span>
<span><span class="va">problematic_sex</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">STATUS</span> <span class="op">!=</span> <span class="st">"OK"</span>, <span class="op">]</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-5">Function 5<a class="anchor" aria-label="anchor" href="#function-5"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">Xhwe</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>Xhwe</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>Xhwe: Filter X-chromosome variants for HWE in females.</h3>

<h4>Description</h4>

<p>This function is a part of the post-imputation quality control process prior to GWAS. This tests for Hardy-Weinberg
Equilibrium (HWE) for X-chromosome variants in females. Males' hemizygous X chromosome prevents testing for HWE on
their haploid X calls, and testing for HWE across all samples would have a high failure rate. This function will check
for HWE across the X in females (cases and controls combined), following the recommendation in Khramtsova et al., 2023,
and can remove these regions from analysis in all samples. The p-value threshold for filtering out SNPs is 0.05/no.of.
X-chromosome variants.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/Xhwe.html">Xhwe</a></span><span class="op">(</span><span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">finput</span>, filterSNP <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">foutput</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>Character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>Character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="filterSNP">filterSNP</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for filtering out the X-chromosome variants i.e., SNPs from the input file or not
(i.e., only flagged). The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output PLINK binary files if filtering option for the SNPs is chosen.
The default is "FALSE".</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A list object containing SNPs. If <code>filterSNP</code> = <code>TRUE</code>, the output filtered PLINK binary files will be
produced inside <code>DataDir</code>.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"Test_output"</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Xhwe.html">Xhwe</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>,</span>
<span>    finput <span class="op">=</span> <span class="va">finput</span>, foutput <span class="op">=</span> <span class="va">foutput</span>, filterSNP <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-6">Function 6<a class="anchor" aria-label="anchor" href="#function-6"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">MAFdiffSexControl</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>MAFdiffSexControl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>MAFdiffSexControl: Test for significantly different minor allele frequency (MAF) between sexes in control samples</h3>

<h4>Description</h4>

<p>With parameters to filter out SNPs and/or flag the SNPs, this function tests for significantly different MAF
(p-value &lt; 0.05/no. of SNPs) between sexes in control samples solely for binary phenotypes. Since the disparities
may be caused by technical confounding or sample biases for the research cohorts, it is advised that any SNPs in
the controls with a sex difference in MAF be carefully evaluated and identified for further examination
(Khramtsova et. al., 2023). In autosomal allele frequencies, sex differences are not anticipated.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/MAFdiffSexControl.html">MAFdiffSexControl</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  filterSNP <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  foutput <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>Character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>Character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files with both male and female samples.
This file needs to be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="filterSNP">filterSNP</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for filtering out the SNPs or not (i.e., only flagged). The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output PLINK binary files if filtering option for the SNPs
is chosen. The default is NULL.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A list object containing excluded or flagged SNPs. If <code>filterSNP</code> = <code>TRUE</code>, the output filtered PLINK binary
files will be produced inside <code>DataDir</code>.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"Test_output"</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MAFdiffSexControl.html">MAFdiffSexControl</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span>, filterSNP <span class="op">=</span> <span class="cn">TRUE</span>, foutput <span class="op">=</span> <span class="va">foutput</span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-7">Function 7<a class="anchor" aria-label="anchor" href="#function-7"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">FilterRegion</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>FilterRegion</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>FilterRegion: Filter chromosomal regions.</h3>

<h4>Description</h4>

<p>Filtering Pseudo-Autosomal Region (PAR), X-transposed region (XTR), Ampliconic, filter based on chromosome code or
user-defined regions from input plink files. Only one type of filtering can be done from three types, either by region
(using <code>regionfile</code> = <code>TRUE</code>), by chromosome (<code>filterCHR</code>) or by any combination of these three, <code>filterPAR</code>,
<code>filterXTR</code> and <code>filterAmpliconic.</code>
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/FilterRegion.html">FilterRegion</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  <span class="va">ResultDir</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  <span class="va">foutput</span>,</span>
<span>  CHRX <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  CHRY <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  filterPAR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filterXTR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filterAmpliconic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  regionfile <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  filterCHR <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Hg <span class="op">=</span> <span class="st">"19"</span>,</span>
<span>  exclude <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output PLINK binary files if the filtering option for the SNPs is chosen.
The default is "FALSE".</p>
</td>
</tr>
<tr>
<td><code id="CHRX">CHRX</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> to filter/flag regions from chromosome X. The default is <code>TRUE</code>. Note: <code>CHRX</code> only in effect if
one of <code>filterPAR</code>, <code>filterXTR</code> or <code>filterAmpliconic</code> filter is in effect.</p>
</td>
</tr>
<tr>
<td><code id="CHRY">CHRY</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> to filter/flag regions from chromosome X. The default is <code>FALSE</code>. Note: CHRY only in effect
if one of <code>filterPAR</code>, <code>filterXTR</code> or <code>filterAmpliconic</code> filter is in effect.</p>
</td>
</tr>
<tr>
<td><code id="filterPAR">filterPAR</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> to filter out PARs from input plink file. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="filterXTR">filterXTR</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> to filter out XTRs from input plink file. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="filterAmpliconic">filterAmpliconic</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> to filter out Ampliconic regions from input plink file. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="regionfile">regionfile</code></td>
<td>
<p>Character string, specifying the name of the .txt file containing the user-defined regions to be filtered out from input plink
file in bed format. The default is <code>FALSE</code>. If <code>regionfile</code> = <code>TRUE</code>, only this filtering will be in effect. Also, PAR, XTR and
Ampliconic SNPs from X-chomosome will be flagged and returned.</p>
</td>
</tr>
<tr>
<td><code id="filterCHR">filterCHR</code></td>
<td>
<p>Vector value with positive integer, specifying the chromosome code to filter/flag the SNPs. The default is 0, means no filtering
based on chromosome code. For non-zero values of this argument, the function will only consider the chromosome code to filter or
flag. All other filtering will not work. If filterCHR = TRUE, only this filtering will be in effect. Also, PAR, XTR and Ampliconic
SNPs from X-chomosome will be flagged and returned.</p>
</td>
</tr>
<tr>
<td><code id="Hg">Hg</code></td>
<td>
<p>Character value, '19', or '38', specifying which genome build to use for PAR, XTR and Ampliconic regions. The default is Hg = "19".</p>
</td>
</tr>
<tr>
<td><code id="exclude">exclude</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> to filter and flag or only flag the SNPs. The default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A list of three dataframes: PAR containing SNPs from PAR regions; XTR containing SNPs from XTR region and Ampliconic containing
SNPs from Ampliconic region.
</p>
<p>For non-zero value of <code>filterCHR</code>, a dataframe containing the excluded/flagged SNPs will be returned.
</p>
<p>For <code>exclude</code> = <code>TRUE</code>, two sets of plink binary files will be produced in ResultDir. One set will have the remaining SNPs after
filtering and other one will have the discarded SNPs.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"PostimputeEX_QC1"</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FilterRegion.html">FilterRegion</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>,</span>
<span>    finput <span class="op">=</span> <span class="va">finput</span>, foutput <span class="op">=</span> <span class="va">foutput</span>, CHRX <span class="op">=</span> <span class="cn">TRUE</span>, CHRY <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    filterPAR <span class="op">=</span> <span class="cn">TRUE</span>, filterXTR <span class="op">=</span> <span class="cn">TRUE</span>, filterAmpliconic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    regionfile <span class="op">=</span> <span class="cn">FALSE</span>, filterCHR <span class="op">=</span> <span class="cn">NULL</span>, Hg <span class="op">=</span> <span class="st">"38"</span>, exclude <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-8">Function 8<a class="anchor" aria-label="anchor" href="#function-8"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">GXwas</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>GXwas</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>GXwas: Running genome-wide association study (GWAS) and X-chromosome-wide association study (XWAS) models.</h3>

<h4>Description</h4>

<p>This function runs GWAS models in autosomes with several alternative XWAS models.
Models such as "FMcombx01","FMcombx02",and "FMstatrified" can be applied to both binary and quantitative traits,
while "GWAcxci" can only be applied to a binary trait.
</p>
<p>For binary and quantitative features, this function uses logistic and linear regression,
allowing for multiple covariates and the interactions with those covariates in a multiple-regression approach.
These models are all run using the additive effects of SNPs, and each additional minor allele's influence
is represented by the direction of the regression coefficient.
</p>
<p>This function attempts to identify the multi-collinearity among predictors by displaying NA for the test statistic
and a p-value for all terms in the model. The more terms you add, the more likely you are to run into issues.
</p>
<p>For details about the different XWAS model, please follow the associated publication.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/GXwas.html">GXwas</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  <span class="va">ResultDir</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"binary"</span>, <span class="st">"quantitative"</span><span class="op">)</span>,</span>
<span>  standard_beta <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xmodel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FMcombx01"</span>, <span class="st">"FMcombx02"</span>, <span class="st">"FMstatrified"</span>, <span class="st">"GWAScxci"</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xsex <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  covarfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  interaction <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  covartest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ALL"</span><span class="op">)</span>,</span>
<span>  Inphenocov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ALL"</span><span class="op">)</span>,</span>
<span>  combtest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fisher.method"</span>, <span class="st">"fisher.method.perm"</span>, <span class="st">"stouffer.method"</span><span class="op">)</span>,</span>
<span>  MF.zero.sub <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  MF.mc.cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  MF.na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  MF.p.corr <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  plot.jpeg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plotname <span class="op">=</span> <span class="st">"GXwas.plot"</span>,</span>
<span>  snp_pval <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  annotateTopSnp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  suggestiveline <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  genomewideline <span class="op">=</span> <span class="fl">7.3</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>Character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>Character string for the folder path where the outputs will be saved.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files with both male and female samples.
This file needs to be in <code>DataDir</code>.
</p>
<p>Note: Case/control phenotypes are expected to be encoded as 1=unaffected (control), 2=affected (case); 0 is accepted as
an alternate missing value encoding. The missing case/control or quantitative phenotypes are expected to be encoded as 'NA'/'nan'
(any capitalization) or -9.</p>
</td>
</tr>
<tr>
<td><code id="trait">trait</code></td>
<td>
<p>Boolean value, 'binary' or 'quantitative' for the phenotype i.e. the trait.</p>
</td>
</tr>
<tr>
<td><code id="standard_beta">standard_beta</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> in case of quantitative trait for standardizing the trait or phenotype values
(mean 0, unit variance), so the resulting coefficients will be standardized. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="xmodel">xmodel</code></td>
<td>
<p>Models "FMcombx01","FMcombx02",and "FMstatrified" can be chosen for both binary and quantitative traits
while "GWAcxci" can only apply to the binary trait. These models take care of the X-chromosomal marker.
Three female genotypes are coded by 0, 1, and 2 in FM01 and FM02. The two genotypes of males that follow the
X-chromosome inactivation (XCI) pattern as random (XCI-R) in the FM01 model are coded by 0 and 1, while the two
genotypes that follow the XCI is escaped (XCI-E) in the FM02 model are coded by 0 and 1. To reflect the dose
compensation connection between the sexes, FM02 treats men as homozygous females.
</p>
<p>In the FM01comb and FM01comb methods, associations are tested separately for males and females with the FM01 and FM02
models, respectively, and then the combined p values are computed the Fisher's method, Fisher's method with permutation,
or Stouffer's method(1,3-7]. An X-chromosome inactivation (XCI) pattern, or coding technique for X-chromosomal genotypes
between sexes, is not required for the XCGA. By simultaneously accounting for four distinct XCI patterns, namely XCI-R, XCI-E,
XCI-SN (XCI fully toward normal allele), and XCI-SR (XCI fully toward risk allele), this model may maintain a
respectably high power (Su et al. 2022).
</p>
<p>Note: <code>sex</code> shouldn't be provided as a covariate in the XCGA model.</p>
</td>
</tr>
<tr>
<td><code id="sex">sex</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for using sex as covariate in association test. It is applicable genome-wide.
</p>
<p>The default is FALSE.</p>
</td>
</tr>
<tr>
<td><code id="xsex">xsex</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for using sex as covariate in association test for X-chromosomal SNPs.
The default is FALSE. This will overwrite 'sex' argument for X-chromosome.</p>
</td>
</tr>
<tr>
<td><code id="covarfile">covarfile</code></td>
<td>
<p>Character string for the full name of the covariate file in .txt format. This file should be placed in <code>DataDir</code>.
</p>
<p>Note about the covariate file: The first column of this file should be <code>FID</code>, the second column should be <code>IID</code> and
the other columns should be covariates. The primary header line should be there starting with “FID”, and “IID”
followed by covariate names. If an individual is not present in the covariate file, or if the individual has a
missing phenotype value (i.e. -9 by default) for the covariate, then that individual is set to missing (i.e. will
be excluded from association analysis). It is important to note that for statrified GWAS model, if PCs are included
as covar then it should be generated separately for each cohort and then included in the covarfile. Use the function
<code>DummyCovar</code> to generate a new covariate file with categorical variables down-coded as binary dummy variables for
the covariate file with categorical variables. For instance, if a variable has K categories, K-1 new dummy variables
are constructed, and the original covariate is now estimated with a coefficient for each category.</p>
</td>
</tr>
<tr>
<td><code id="interaction">interaction</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for including SNP x covariate interaction term/terms from the association analysis.
The default is <code>FALSE</code>. If a permutation procedure is chosen then the interaction will be automatically <code>FALSE</code>. For the
interaction with the two covariates COV1 and COV2, the model will look like: <code class="reqn">Y = b0 + b1.ADD + b2.COV1 + b3.COV2 +
b4.ADD x COV1 + b5.ADD x COV2 + e</code>. When interaction factors are incorporated into the model, the main effects'
significance is not always determined simply; rather, it depends on the arbitrary coding of the variables. To put it
another way, you should probably just interpret the p-value for the interaction. Also, The p-values for the covariates
do not represent the test for the SNP-phenotype association after controlling for the covariate. That is the first row
(ADD). Rather, the covariate term is the test associated with the covariate-phenotype association. These p-values might
be extremely significant (e.g. if one covaries for smoking in an analysis of heart disease, etc) but this does not mean
that the SNP has a highly significant effect necessarily. Note that, this feature is not valid for XCGA model for XWAS part.</p>
</td>
</tr>
<tr>
<td><code id="covartest">covartest</code></td>
<td>
<p>Vector value with <code>NULL</code>,"ALL" or covarite name/names to be included in the test. The default is <code>NULL.</code> For instance,
the user can choose “AGE” and “SEX” as covartest = c(“AGE”, “SEX”) or all the covariates as covartest = c(“ALL”).</p>
</td>
</tr>
<tr>
<td><code id="Inphenocov">Inphenocov</code></td>
<td>
<p>Vector of integer values starting from 1 to extract the terms which user wants from the above model:
<code class="reqn">Y = b0 + b1.ADD + b2.COV1 + b3.COV2 + b4.ADDxCOV1 + b5.ADDxCOV2 + e</code>. The terms will appear in order as
(Purcell et al. 2007) for ADD, (Su et al. 2022) for COV1, (Rhodes 2002) for ADD x COV1,
and (Moreau and others 2003) for ADD x COV2. If the user wants to extract the terms for COV1 and ADD x COV1, they need to specify it as c(2,4).
The default is <code style="white-space: pre;">⁠c(“ALL”)⁠</code>.
</p>
<p>Note: This feature is not valid for the XCGA model for the XWAS part.</p>
</td>
</tr>
<tr>
<td><code id="combtest">combtest</code></td>
<td>
<p>Character vector specifying method for combining p-values for stratified GWAS with FM01comb and FM02comb XWAS models.
Choices are “stouffer.method”, "fisher.method" and "fisher.method.perm". For fisher.method the function for combining
p-values uses a statistic, <code class="reqn">S = -2 ∑^k /log p</code>, which follows a <code class="reqn">χ^2</code> distribution with 2k degrees of freedom (Fisher 1925).
</p>
<p>For fisher.method.perm, using p-values from stratified tests, the summary statistic for combining p-values is <code class="reqn">S = -2 ∑ /log p</code>.
A p-value for this statistic can be derived by randomly generating summary statistics (Rhodes 2002). Therefore, a p-value is randomly
sampled from each contributing study, and a random statistic is calculated. The fraction of random statistics greater or
equal to S then gives the final p-value.
</p>
<p>For stouffer.method ,the function applies Stouffer’s method (Stouffer et al. 1949) to the p-values assuming that the p-values to be combined are
independent. Letting p1, p2, . . . , pk denote the individual (one- or two-sided) p-values of the k hypothesis tests to be
combined, the test statistic is then computed with <code class="reqn">$z = ∑^k_{1}frac{z_{i}}{sqrt(k)}$</code> where <code class="reqn">$z_{i}$ = Φ−1 (1 – $p_{i}$)</code> and
<code class="reqn">Φ −1 (·)</code> denotes the inverse of the cumulative distribution function of a standard normal distribution. Under the joint null
hypothesis, the test statistic follows a standard normal distribution which is used to compute the combined p-value. This
functionality is taken from the R package poolr (Cinar and Viechtbauer 2022).
</p>
<p>Note that only p-values between 0 and 1 are allowed to be passed to these methods.</p>
</td>
</tr>
<tr>
<td><code id="MF.zero.sub">MF.zero.sub</code></td>
<td>
<p>Small numeric value for substituting p-values of 0 in in stratified GWAS with FM01comb and FM02comb XWAS models.
The default is 0.00001. As log(0) results in Inf this replaces p-values of 0 by default with a small float.</p>
</td>
</tr>
<tr>
<td><code id="B">B</code></td>
<td>
<p>Integer value specifying the number of permutation in case of using fisher.method.perm method in stratified GWAS with
FM01comb and FM02comb XWAS models. The default is 10000.</p>
</td>
</tr>
<tr>
<td><code id="MF.mc.cores">MF.mc.cores</code></td>
<td>
<p>Number of cores used for fisher.method.perm in stratified GWAS with FM01comb and FM02comb XWAS models.</p>
</td>
</tr>
<tr>
<td><code id="MF.na.rm">MF.na.rm</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for removing p-values of NA in stratified GWAS with FM01comb and FM02comb XWAS
in case of using Fisher’s and Stouffer’s methods. The default is FALSE.</p>
</td>
</tr>
<tr>
<td><code id="MF.p.corr">MF.p.corr</code></td>
<td>
<p>Character vector specifying method for correcting the summary p-values for FMfcomb and FMscomb models. Choices
are "bonferroni", "BH" and "none" for Bonferroni,  Benjamini-Hochberg and none, respectively. The default is "none".</p>
</td>
</tr>
<tr>
<td><code id="plot.jpeg">plot.jpeg</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for saving the plots in .jpeg file. The default is TRUE.</p>
</td>
</tr>
<tr>
<td><code id="plotname">plotname</code></td>
<td>
<p>A character string specifying the prefix of the file for plots. This file will be saved in DataDir. The default is
"GXwas.plot".</p>
</td>
</tr>
<tr>
<td><code id="snp_pval">snp_pval</code></td>
<td>
<p>Numeric value as p-value threshold for annotation. SNPs below this p-value will be annotated on the plot. The default
is 1e-08.</p>
</td>
</tr>
<tr>
<td><code id="annotateTopSnp">annotateTopSnp</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or 'FALSE. If TRUE, it only annotates the top hit on each chromosome that is below the
snp_pval threshold. The default is FALSE.</p>
</td>
</tr>
<tr>
<td><code id="suggestiveline">suggestiveline</code></td>
<td>
<p>The default is 5 (for p-value 1e-05).</p>
</td>
</tr>
<tr>
<td><code id="genomewideline">genomewideline</code></td>
<td>
<p>The default is 7.3 (for p-value 5e-08).</p>
</td>
</tr>
<tr>
<td><code id="ncores">ncores</code></td>
<td>
<p>Integer value, specifying the number of cores for parallel processing. The default is 0 (no parallel computation).</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A dataframe with GWAS (with XWAS for X-chromosomal variants) along with Manhattan and Q-Q plots.
In the case of the stratified test, the return is a list containing three dataframes, namely, FWAS, MWAS, and MFWAS with association
results in only female, only male, and both cohorts, respectively. This will be accompanied by Miami and Q-Q plots. The individual manhattan
and Q-Q-plots for stratified tests prefixed with xmodel type will be in the DataDir.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>References</h4>

<p>Cinar O, Viechtbauer W (2022).
“The poolr package for combining independent and dependent p values.”
<em>Journal of Statistical Software</em>, <b>101</b>(1), 1–42.
<a href="https://doi.org/10.18637/jss.v101.i01" class="external-link">doi:10.18637/jss.v101.i01</a>.<br><br> Fisher RA (1925).
<em>Statistical Methods for Research Workers</em>.
Oliver and Boyd, Edinburgh.<br><br> Moreau Y, others (2003).
“Comparison and meta-analysis of microarray data: from the bench to the computer desk.”
<em>Trends in Genetics</em>, <b>19</b>(10), 570–577.<br><br> Purcell S, Neale B, Todd-Brown K, Thomas L, Ferreira MAR, Bender D, Maller J, Sklar P, de Bakker PIW, Daly MJ, others (2007).
“PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses.”
<em>The American Journal of Human Genetics</em>, <b>81</b>(3), 559–575.
<a href="https://doi.org/10.1086/519795" class="external-link">doi:10.1086/519795</a>.<br><br> Rhodes DR (2002).
“Meta-analysis of microarrays: interstudy validation of gene expression profiles reveals pathway dysregulation in prostate cancer.”
<em>Cancer Research</em>, <b>62</b>(15), 4427–4433.<br><br> Stouffer SA, Suchman EA, DeVinney LC, Star SA, Williams RM (1949).
<em>The American Soldier: Adjustment During Army Life</em>, volume 1.
Princeton University Press, Princeton, NJ.<br><br> Su Y, Hu J, Yin P, Jiang H, Chen S, Dai M, Chen Z, Wang P (2022).
“XCMAX4: A Robust X Chromosomal Genetic Association Test Accounting for Covariates.”
<em>Genes (Basel)</em>, <b>13</b>(5), 847.
<a href="https://doi.org/10.3390/genes13050847" class="external-link">doi:10.3390/genes13050847</a>, <a href="http://www.ncbi.nlm.nih.gov/pubmed/35627231" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/35627231</a>.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span></span>
<span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">standard_beta</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">xsex</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">Inphenocov</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">covartest</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">interaction</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">MF.na.rm</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">MF.zero.sub</span> <span class="op">&lt;-</span> <span class="fl">0.00001</span></span>
<span><span class="va">trait</span> <span class="op">&lt;-</span> <span class="st">"binary"</span></span>
<span><span class="va">xmodel</span> <span class="op">&lt;-</span> <span class="st">"FMcombx02"</span></span>
<span><span class="va">combtest</span> <span class="op">&lt;-</span> <span class="st">"fisher.method"</span></span>
<span><span class="va">snp_pval</span> <span class="op">&lt;-</span> <span class="fl">1e-08</span></span>
<span><span class="va">covarfile</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">ncores</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">MF.mc.cores</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">ResultGXwas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GXwas.html">GXwas</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>,</span>
<span>    finput <span class="op">=</span> <span class="va">finput</span>, xmodel <span class="op">=</span> <span class="va">xmodel</span>, trait <span class="op">=</span> <span class="va">trait</span>, covarfile <span class="op">=</span> <span class="va">covarfile</span>,</span>
<span>    sex <span class="op">=</span> <span class="va">sex</span>, xsex <span class="op">=</span> <span class="va">xsex</span>, combtest <span class="op">=</span> <span class="va">combtest</span>, MF.p.corr <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    snp_pval <span class="op">=</span> <span class="va">snp_pval</span>, plot.jpeg <span class="op">=</span> <span class="cn">TRUE</span>, suggestiveline <span class="op">=</span> <span class="fl">5</span>, genomewideline <span class="op">=</span> <span class="fl">7.3</span>,</span>
<span>    MF.mc.cores <span class="op">=</span> <span class="fl">1</span>, ncores <span class="op">=</span> <span class="va">ncores</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-9">Function 9<a class="anchor" aria-label="anchor" href="#function-9"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">PvalComb</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>PvalComb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>PvalComb</h3>

<h4>Description</h4>

<p>This function combines the p-values of two separate GWAS summary statistics (for instance male and female populations),
merges them, and then applies various statistical methods (like Stouffer's method, Fisher's method) to integrate the
p-values. It also includes functionality for generating plots like Manhattan plots and Q-Q plots.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/PvalComb.html">PvalComb</a></span><span class="op">(</span></span>
<span>  <span class="va">SumstatMale</span>,</span>
<span>  <span class="va">SumstatFemale</span>,</span>
<span>  <span class="va">combtest</span>,</span>
<span>  MF.p.corr <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  MF.zero.sub <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  MF.na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  MF.mc.cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  plot.jpeg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plotname <span class="op">=</span> <span class="st">"GXwas.plot"</span>,</span>
<span>  PlotDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">snp_pval</span>,</span>
<span>  annotateTopSnp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  suggestiveline <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  genomewideline <span class="op">=</span> <span class="fl">7.3</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="SumstatMale">SumstatMale</code></td>
<td>
<p>R dataframe object of summary statistics of male GWAS with five mandatory columns:
</p>

<ul>
<li> <p><code>CHR</code> (numeric chromosome code)
</p>
</li>
<li> <p><code>SNP</code> (variant id)
</p>
</li>
<li> <p><code>A1</code> (allele)
</p>
</li>
<li> <p><code>POS</code> (base-pair position)
</p>
</li>
<li> <p><code>P</code> (p-value).
</p>
</li>
</ul>
<p>Other coulmns may present.</p>
</td>
</tr>
<tr>
<td><code id="SumstatFemale">SumstatFemale</code></td>
<td>
<p>R dataframe object of summary statistics of female GWAS with five mandatory columns:
</p>

<ul>
<li> <p><code>SNP</code>
</p>
</li>
<li> <p><code>A1</code>
</p>
</li>
<li> <p><code>TEST</code>
</p>
</li>
<li> <p><code>POS</code>
</p>
</li>
<li> <p><code>P</code>
</p>
</li>
</ul>
<p>Other coulmns may present.</p>
</td>
</tr>
<tr>
<td><code id="combtest">combtest</code></td>
<td>
<p>Character vector specifying method for combining p-values for stratified GWAS models. Choices are “stouffer.method”,
"fisher.method" and "fisher.method.perm". For fisher.method the function for combining p-values uses a statistic,
<code class="reqn">S = -2 ∑^k /log p</code>, which follows a <code class="reqn">χ^2</code> distribution with 2k degrees of freedom (Fisher 1925).
For fisher.method.perm, using p-values from stratified tests, the summary statistic for combining p-values
is <code class="reqn">S = -2 ∑ /log p</code>. A p-value for this statistic can be derived by randomly generating summary statistics (Rhodes 2002).
Therefore, a p-value is randomly sampled from each contributing study, and a random statistic is calculated. The
fraction of random statistics greater or equal to S then gives the final p-value.</p>
</td>
</tr>
<tr>
<td><code id="MF.p.corr">MF.p.corr</code></td>
<td>
<p>Character vector specifying method for correcting the summary p-values for FMfcomb and FMscomb models. Choices are
"bonferroni", "BH" and "none" for Bonferroni,  Benjamini-Hochberg and none, respectively. The default is "none".</p>
</td>
</tr>
<tr>
<td><code id="MF.zero.sub">MF.zero.sub</code></td>
<td>
<p>Small numeric value for substituting p-values of 0 in GWAS summary statistics. The default is 0.00001. As <code class="reqn">log(0)</code>
results in Inf this replaces p-values of 0 by default with a small float.</p>
</td>
</tr>
<tr>
<td><code id="MF.na.rm">MF.na.rm</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for removing p-values of NA in stratified GWAS summary satistics in case of using Fisher’s
and Stouffer’s methods. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="MF.mc.cores">MF.mc.cores</code></td>
<td>
<p>Number of cores used for fisher.method.perm for combining p-values. The default is 1.</p>
</td>
</tr>
<tr>
<td><code id="B">B</code></td>
<td>
<p>Integer value specifying the number of permutation in case of using fisher.method.perm method. The default is 10000.</p>
</td>
</tr>
<tr>
<td><code id="plot.jpeg">plot.jpeg</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for saving the plots in .jpeg file. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="plotname">plotname</code></td>
<td>
<p>A character string specifying the prefix of the file for plots. This file will be saved in DataDir.
The default is "GXwas.plot".</p>
</td>
</tr>
<tr>
<td><code id="PlotDir">PlotDir</code></td>
<td>
<p>A character string specifying the path of the directory where the plots will be saved. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="snp_pval">snp_pval</code></td>
<td>
<p>Numeric value as p-value threshold for annotation. SNPs below this p-value will be annotated on the plot. The default is 1e-08.</p>
</td>
</tr>
<tr>
<td><code id="annotateTopSnp">annotateTopSnp</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE.</code> If <code>TRUE</code>, it only annotates the top hit on each chromosome that is below the snp_pval threshold. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="suggestiveline">suggestiveline</code></td>
<td>
<p>Numeric value for suggestive cut-off line in GWAS manhattan plot. The default is 5 (for p-value 1e-05).</p>
</td>
</tr>
<tr>
<td><code id="genomewideline">genomewideline</code></td>
<td>
<p>Numeric value for genome-wide significant cut-off line in GWAS manhattan plot. The default is 7.3 (for p-value 5e-08).</p>
</td>
</tr>
<tr>
<td><code id="ncores">ncores</code></td>
<td>
<p>Integer value, specifying the number of cores for parallel processing. The default is 0 (no parallel computation).</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A dataframe with GWAS summary statistics (with XWAS for X-chromosomal variants) along with Manhattan and Q-Q plots.
</p>


<h4>References</h4>

<p>Fisher RA (1925).
<em>Statistical Methods for Research Workers</em>.
Oliver and Boyd, Edinburgh.<br><br> Rhodes DR (2002).
“Meta-analysis of microarrays: interstudy validation of gene expression profiles reveals pathway dysregulation in prostate cancer.”
<em>Cancer Research</em>, <b>62</b>(15), 4427–4433.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Mfile"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Ffile"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">SumstatMale</span> <span class="op">&lt;-</span> <span class="va">Mfile</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">SumstatMale</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"POS"</span></span>
<span><span class="va">SumstatFemale</span> <span class="op">&lt;-</span> <span class="va">Ffile</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">SumstatFemale</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"POS"</span></span>
<span><span class="va">PvalComb_Result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PvalComb.html">PvalComb</a></span><span class="op">(</span></span>
<span>    SumstatMale <span class="op">=</span> <span class="va">SumstatMale</span>, SumstatFemale <span class="op">=</span> <span class="va">SumstatFemale</span>,</span>
<span>    combtest <span class="op">=</span> <span class="st">"fisher.method"</span>, MF.mc.cores <span class="op">=</span> <span class="fl">1</span>, snp_pval <span class="op">=</span> <span class="fl">0.001</span>, plot.jpeg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    suggestiveline <span class="op">=</span> <span class="fl">3</span>, genomewideline <span class="op">=</span> <span class="fl">5.69897</span>, ncores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-10">Function 10<a class="anchor" aria-label="anchor" href="#function-10"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">SexDiff</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>SexDiff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>SexDiff: Sex difference in effect size for each SNP using t-test.</h3>

<h4>Description</h4>

<p>This function uses the GWAS summary statistics from sex-stratified tests like FM01comb or FM02comb, to evaluate
the difference in effect size between males and females at each SNP using a t-test.
</p>
<p>The input dataframes should only include X-chromosome in order to obtain results for sex differences based solely
on X-linked loci.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/SexDiff.html">SexDiff</a></span><span class="op">(</span><span class="va">Mfile</span>, <span class="va">Ffile</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="Mfile">Mfile</code></td>
<td>
<p>R dataframe of summary statistics of GWAS or XWAS of male samples with six mandatory columns, SNP(Variant),CHR(Chromosome number),
BP(Base pair position),A1(Minor allele),BETA_M(Effect size) and SE_M(Standard error). This can be generated by running FM01comb or
FM02comb model with GXWAS function.</p>
</td>
</tr>
<tr>
<td><code id="Ffile">Ffile</code></td>
<td>
<p>R dataframe of summary statistics of GWAS or XWAS of male samples with six mandatory columns, SNP(Variant),CHR(Chromosome number),
BP(Base pair position),A1(Minor allele),BETA_F(Effect size) and SE_F(Standard error). This can be generated by running FM01comb or
FM02comb model with GXWAS function.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>R dataframe with seven columns:
</p>

<ul>
<li> <p><code>SNP</code> (Variant)
</p>
</li>
<li> <p><code>CHR</code> (Chromosome number)
</p>
</li>
<li> <p><code>BP</code> (Base pair position)
</p>
</li>
<li> <p><code>A1</code> (Minor allele)
</p>
</li>
<li> <p><code>tstat</code> (t-statistics for effect-size test)
</p>
</li>
<li> <p><code>P</code> (p-value) and
</p>
</li>
<li> <p><code>adjP</code> (Bonferroni corrected p-value)
</p>
</li>
</ul>
<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Mfile"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Ffile"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">Difftest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SexDiff.html">SexDiff</a></span><span class="op">(</span><span class="va">Mfile</span>, <span class="va">Ffile</span><span class="op">)</span></span>
<span><span class="va">significant_snps</span> <span class="op">&lt;-</span> <span class="va">Difftest</span><span class="op">[</span><span class="va">Difftest</span><span class="op">$</span><span class="va">adjP</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="op">]</span> <span class="co"># 9</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-11">Function 11<a class="anchor" aria-label="anchor" href="#function-11"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">SexDiffZscore</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>SexDiffZscore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>SexDiffZscore: Z-score-based sex difference test.</h3>

<h4>Description</h4>

<p>This function calculates the difference in any kind of measured entities,(example: including SNP heritability estimate,
genetic correlation, and GWAS β values) between sexes using a Z-score and its associated p-value statistic.
When STAT/SE is normally distributed and the test statistics are independent in sex, the test is well calibrated. If
the statistics are positively correlated, this test is conservative (1).
</p>
<p>We could define SNPs with SDEs as those variants at the extreme ends of the distribution with an absolute value of the
Z-score greater than 3(|Z-score| &gt; 3), which is roughly equivalent to p &lt;10−3, and represents 0.3% of all tested SNPs.
The input dataframes should only include X-chromosome in order to obtain results for sex differences based solely on
X-linked loci.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/SexDiffZscore.html">SexDiffZscore</a></span><span class="op">(</span><span class="va">inputdata</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table"><tr>
<td><code id="inputdata">inputdata</code></td>
<td>
<p>A dataframe with five columns:
</p>

<ul>
<li> <p><code>ID</code> (i.e., SNP ID or the phenotype of interest, etc.)
</p>
</li>
<li> <p><code>Fstat</code> (i.e., the measured statistics in females)
</p>
</li>
<li> <p><code>Fse</code> (i.e., the standard error of the measured statistics in females)
</p>
</li>
<li> <p><code>Mstat</code> (i.e., the measured statistics in males)
</p>
</li>
<li> <p><code>Mse</code> (i.e., the standard error of the measured statistics in males)
</p>
</li>
</ul>
</td>
</tr></table>
<h4>Value</h4>

<p>Original input dataframe with:
</p>

<ul>
<li> <p><code>Zscore</code> (i.e., Z-score),
</p>
</li>
<li> <p><code>p</code> (i.e., p-value) and
</p>
</li>
<li> <p><code>adjP</code> (i.e., Bonferroni corrected p-value)
columns added.
</p>
</li>
</ul>
<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Example_h2data"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">inputdata</span> <span class="op">&lt;-</span> <span class="va">Example_h2data</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SexDiffZscore.html">SexDiffZscore</a></span><span class="op">(</span><span class="va">inputdata</span><span class="op">)</span></span>
<span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-12">Function 12<a class="anchor" aria-label="anchor" href="#function-12"></a>
</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">DiffZeroOne</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>DiffZeroOne</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>DiffZeroOne: Assessing the Z-score for deviation from one and zero.</h3>

<h4>Description</h4>

<p>This function tests the null hypothesis that a measured statistics (example: genetic correlation,
rg for a trait) &lt; 1 using a 1-tailed test compared with a normal distribution (z = (1 − measure statistics)/Standard error).
For multiple tests, users are encouraged to apply a Bonferroni multiple-testing correction.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/DiffZeroOne.html">DiffZeroOne</a></span><span class="op">(</span><span class="va">inputdata</span>, diffzero <span class="op">=</span> <span class="cn">TRUE</span>, diffone <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="inputdata">inputdata</code></td>
<td>
<p>A dataframe object, contaning three columns:
</p>

<ul>
<li> <p><code>Trait</code> (i.e., the phenotype of interest)
</p>
</li>
<li> <p><code>Stat</code> (i.e., the measured statistics)
</p>
</li>
<li> <p><code>SE</code> (i.e., the standard error of the measured statistics)
</p>
</li>
</ul>
</td>
</tr>
<tr>
<td><code id="diffzero">diffzero</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying to perform diviation from 0 test.</p>
</td>
</tr>
<tr>
<td><code id="diffone">diffone</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying to perform diviation from 1 test.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A dataframe with columns:
</p>

<ul>
<li> <p><code>Trait</code>
</p>
</li>
<li> <p><code>Stat</code>
</p>
</li>
<li> <p><code>SE</code>
</p>
</li>
<li> <p><code>P0</code> (i.e, p-value for deviation from zero test)
</p>
</li>
<li> <p><code>P1</code> (i.e., p-value for deviation from 1 test)
</p>
</li>
</ul>
<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Example_rgdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">inputdata</span> <span class="op">&lt;-</span> <span class="va">Example_rgdata</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">inputdata</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Trait"</span>, <span class="st">"Stat"</span>, <span class="st">"SE"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DiffZeroOne.html">DiffZeroOne</a></span><span class="op">(</span><span class="va">inputdata</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-13">Function 13<a class="anchor" aria-label="anchor" href="#function-13"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">TestXGene</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>TestXGene</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>TestXGene: Performing gene-based association test using GWAS/XWAS summary statistics.</h3>

<h4>Description</h4>

<p>This function performs gene-based association tests using GWAS/XWAS summary statistics and SNP-SNP correlation
matrices. For  SNP-SNP correlation matrices, users have the flexibility to use either the base genotype data or 1000 Genomes
Phase 3 reference genotype data. Users also have options to define the regional positions of genes to include the SNPs according
to their investigation.
</p>
<p>This function computes gene-wise SNP-SNP correlation matrices and can perform nine different gene-based tests, such as, “BT" (burden test),
"SKAT" (sequence kernel association test), "SKATO" (combination of BT and SKAT), "sumchi" (sum of χ2-statistics), "ACAT" (aggregated
Cauchy association test for combining P values), "PCA"(principal component approach), "FLM"( functional multiple linear regression model),
"simpleM" (Bonferroni correction test), "minp" (minimum P-value) leveraging PLINK1.9 (Purcell et al. 2007) and sumFREGAT
(Svishcheva et al. 2019; Belonogova et al. 2022) tools.
</p>
<p>Though this function implicitly performs X-linked gene-based test, it is flexible to perform this analysis genome-wide.
For the details about the different tests, please follow the associated paper.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/TestXGene.html">TestXGene</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  <span class="va">sumstat</span>,</span>
<span>  <span class="va">gene_file</span>,</span>
<span>  gene_range <span class="op">=</span> <span class="fl">5e+05</span>,</span>
<span>  <span class="va">score_file</span>,</span>
<span>  ref_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_gene <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  genebasedTest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SKAT"</span>, <span class="st">"SKATO"</span>, <span class="st">"sumchi"</span>, <span class="st">"ACAT"</span>, <span class="st">"BT"</span>, <span class="st">"PCA"</span>, <span class="st">"FLM"</span>, <span class="st">"simpleM"</span>,</span>
<span>    <span class="st">"minp"</span><span class="op">)</span>,</span>
<span>  gene_approximation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">beta_par</span>,</span>
<span>  <span class="va">weights_function</span>,</span>
<span>  <span class="va">geno_variance_weights</span>,</span>
<span>  kernel_p_method <span class="op">=</span> <span class="st">"kuonen"</span>,</span>
<span>  acc_devies <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  lim_devies <span class="op">=</span> <span class="fl">1e+06</span>,</span>
<span>  rho <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  skato_p_threshold <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  anno_type <span class="op">=</span> <span class="st">""</span>,</span>
<span>  <span class="va">mac_threshold</span>,</span>
<span>  <span class="va">reference_matrix_used</span>,</span>
<span>  <span class="va">regularize_fun</span>,</span>
<span>  pca_var_fraction <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  flm_basis_function <span class="op">=</span> <span class="st">"fourier"</span>,</span>
<span>  flm_num_basis <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  flm_poly_order <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  flip_genotypes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  omit_linear_variant <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the all the input files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files for the genotype data. This file is used to compute the
correlation between the SNPs. This file needs to be in DataDir. If the base genotype data is unavailable, then users can use the
1000 Genomes Project samples. Users should use the population that most closely represents the base sample. For ACAT model, this
parameter is not mandatory and could be set <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="sumstat">sumstat</code></td>
<td>
<p>A dataframe object with GWAS summary statistics. When the base-genotype data is used to compute genetic correlations, the mandatory
columns are:
</p>

<ul>
<li>
<p> Column 1: <code>CHROM</code> (i.e., chromosome code),
</p>
</li>
<li>
<p> Column 2: <code>POS</code> (i.e., base-pair position),
</p>
</li>
<li>
<p> Column 3: <code>ID</code> (i.e. SNP IDs),
</p>
</li>
<li>
<p> Column 4: <code>P</code> (i.e., p-values),
</p>
</li>
<li>
<p> Column 5: <code>BETA</code> (i.e., effect-size),
</p>
</li>
<li>
<p> Column 6: <code>A1</code> (i.e., effect allele),
</p>
</li>
<li>
<p> Column 7: <code>A2</code> (i.e., alternative allele) and
</p>
</li>
<li>
<p> Column 8: <code>EAF</code> (i.e., the effect allele frequency)
</p>
</li>
</ul>
<p>These are mandatory when base-genotype data is used to compute genetic correlations. Otherwise, if the users are using reference data,
then columns 5 to 8 are optional. Also, in that case, columns, such as <code>REF</code> (i.e., reference allele), and <code>ALT</code> (i.e., alternative allele)
could be present to compare alleles with those in the reference file and exclude genetic variants if alleles do not match. There could be an
additional column, <code>ANNO</code> with functional annotations (like "intron_variant", "synonymous", "missense" etc.)</p>
</td>
</tr>
<tr>
<td><code id="gene_file">gene_file</code></td>
<td>
<p>Character string, specifying the prefix of the name of a .txt file listing genes in refFlat format. This file needs to be in <code>DataDir</code>. The
X-linked gene files, "Xlinkedgenes_hg19.txt" and "Xlinkedgenes_hg38.txt" and autosomal gene files, “Autosomes_hg19.txt” and “Autosomes_hg38.txt”
can be specified. The default is "Xlinkedgenes_hg19.txt". The genome built should be in agreement with the analysis.</p>
</td>
</tr>
<tr>
<td><code id="gene_range">gene_range</code></td>
<td>
<p>Integer value, specifying the up stream and down stream range (in kilo base) of a gene for SNPs to be considered. The default is 500000.</p>
</td>
</tr>
<tr>
<td><code id="score_file">score_file</code></td>
<td>
<p>Character string, specifying the prefix of a file which will be used to produce score files with Z scores from P values and beta input
from GWAS summary statistics.</p>
</td>
</tr>
<tr>
<td><code id="ref_data">ref_data</code></td>
<td>
<p>Character string, specifying the path to a reference dataframe with additional data needed to recode user data according to correlation matrices
that will be used. It contains <code>ID</code> column with names of  SNPs,  <code>REF</code> and <code>ALT</code> columns with alleles that were coded as 0 and 1, respectively.
Effect sizes from data will be inverted for variants with effect alleles different from <code>ALT</code> alleles in reference data. If presented, <code>REF</code> and
<code>ALT</code> columns from the input data will be used to sort out variants with alleles different from those in reference data. This dataframe  can also
be a source of map data and allele frequencies if they are not present in data. <code>AF</code> column in the reference file represents the allele frequency
of <code>ALT</code> allele. The default is "ref1KG.MAC5.EUR_AF.RData".</p>
</td>
</tr>
<tr>
<td><code id="max_gene">max_gene</code></td>
<td>
<p>Positive integer value, specifying the number of genes for which the gene-based test will be performed. The default is NULL to consider
all the genes.</p>
</td>
</tr>
<tr>
<td><code id="sample_size">sample_size</code></td>
<td>
<p>Positive integer value, specifying the sample size of the GWAS. Only needed for FLM and PCA models.</p>
</td>
</tr>
<tr>
<td><code id="genebasedTest">genebasedTest</code></td>
<td>
<p>Character string, specifying the name of the gene-based test. Nine different tests can be specified, "SKAT","SKATO","sumchi","ACAT","BT","PCA",
"FLM","simpleM","minp". The default is "SKAT".</p>
</td>
</tr>
<tr>
<td><code id="gene_approximation">gene_approximation</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether approximation for large genes (&gt;= 500 SNPs) should be used. Applicable for SKAT,
SKATO, sumchi, PCA, FLM. The default is <code>TRUE</code> for these methods).</p>
</td>
</tr>
<tr>
<td><code id="beta_par">beta_par</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether approximation for large genes (&gt;= 500 SNPs) should be used. Applicable for SKAT, SKATO,
sumchi, PCA, FLM (default = <code>TRUE</code> for these methods).</p>
</td>
</tr>
<tr>
<td><code id="weights_function">weights_function</code></td>
<td>
<p>A function of MAF to assign weights for each genetic variant. By default is <code>NULL</code>. In this case the weights will be calculated using
the beta distribution.</p>
</td>
</tr>
<tr>
<td><code id="geno_variance_weights">geno_variance_weights</code></td>
<td>
<p>Character string, indicating whether scores should be weighted by the variance of genotypes: "none" (i.e., no weights applied, resulting
in a sum chi-square test); "se.beta" (i.e., scores weighted by variance of genotypes estimated from P values and effect sizes); "af"
(i.e., scores weighted by variance of genotypes calculated as <code class="reqn">AF * (1 - AF)</code>, where AF is allele frequency.</p>
</td>
</tr>
<tr>
<td><code id="kernel_p_method">kernel_p_method</code></td>
<td>
<p>Character string, specifying the method for computing P value in kernel-based tests, such as SKAT, SKATO and sumchi. Available methods
are "kuonen" (Belonogova et al. 2022) "davies" (Belonogova et al. 2022) and "hybrid" (Belonogova et al. 2022).
The default is "kuonen".</p>
</td>
</tr>
<tr>
<td><code id="acc_devies">acc_devies</code></td>
<td>
<p>Positive numeric value, specifying the accuracy parameter for "davies" method. The default is 1e-8.</p>
</td>
</tr>
<tr>
<td><code id="lim_devies">lim_devies</code></td>
<td>
<p>Positive numeric value, specifying the limit parameter for "davies" method. The default is 1e+6.</p>
</td>
</tr>
<tr>
<td><code id="rho">rho</code></td>
<td>
<p>Logical value, 'TRUE' or 'FALSE' or can be a vector of grid values from 0 to 1. If TRUE, the optimal test (SKAT-O) is performed (12).
The default grid is c(0, 0.1^2, 0.2^2, 0.3^2, 0.4^2, 0.5^2, 0.5, 1).</p>
</td>
</tr>
<tr>
<td><code id="skato_p_threshold">skato_p_threshold</code></td>
<td>
<p>Positive numeric value, specifying the largest P value that will be considered as important when performing computational optimization in
SKAT-O. All P values larger than skato_p_threshold will be processed via burden test. The default is 0.8</p>
</td>
</tr>
<tr>
<td><code id="anno_type">anno_type</code></td>
<td>
<p>A character (or character vector) indicating annotation types to be used. The default is "" (i.e, nothing).</p>
</td>
</tr>
<tr>
<td><code id="mac_threshold">mac_threshold</code></td>
<td>
<p>Integer value, specifying the threshold of MACs (Minor allele content) calculated from MAFs. In ACAT, scores with MAC &lt;= 10 will be
combined using Burden test.</p>
</td>
</tr>
<tr>
<td><code id="reference_matrix_used">reference_matrix_used</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> logical indicating whether the correlation matrices were generated using the reference matrix. The
default is <code>FALSE</code>. If  <code>TRUE</code>, regularization algorithms will be applied to ensure the invertibility and numerical stability of
the matrices.</p>
</td>
</tr>
<tr>
<td><code id="regularize_fun">regularize_fun</code></td>
<td>
<p>Character string, specifying the one of two regularization algorithms if ‘reference_matrix’ is TRUE:  'LH' (default) or 'derivLH'.
Currently, both give similar results.</p>
</td>
</tr>
<tr>
<td><code id="pca_var_fraction">pca_var_fraction</code></td>
<td>
<p>P
ositive numeric value, specifying the minimal proportion of genetic variance within the region that should be explained by principal
components used in PCA method. This is also valid in 'simpleM'. The default is 0.85.</p>
</td>
</tr>
<tr>
<td><code id="flm_basis_function">flm_basis_function</code></td>
<td>
<p>Character string, specifying the name of a basis function type for beta-smooth in FLM method. Can be set to "bspline" (B-spline basis)
or "fourier" (Fourier basis, default).</p>
</td>
</tr>
<tr>
<td><code id="flm_num_basis">flm_num_basis</code></td>
<td>
<p>Positive integer value, specifying the number of basis functions to be used for beta-smooth in FLM method. The default is 25.</p>
</td>
</tr>
<tr>
<td><code id="flm_poly_order">flm_poly_order</code></td>
<td>
<p>Positive integer value, specifying the polynomial order to be used in "bspline" for FLM model. The default = 4, which corresponds to
the cubic B-splines. This has no effect if only Fourier bases are used</p>
</td>
</tr>
<tr>
<td><code id="flip_genotypes">flip_genotypes</code></td>
<td>
<p>L
ogical value, <code>TRUE</code> or <code>FALSE</code>, indicating whether the genotypes of some genetic variants should be flipped (relabelled) for their
better functional representation (13). The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="omit_linear_variant">omit_linear_variant</code></td>
<td>
<p>Logical value, <code>TRUE</code> or <code>FALSE</code>, indicating whether to omit linearly dependent genetic variants. It was done in the FLM test (4).
The default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A data frame with columns:
</p>

<ul>
<li>
<p> gene
</p>
</li>
<li>
<p> chrom
</p>
</li>
<li>
<p> start
</p>
</li>
<li>
<p> end
</p>
</li>
<li>
<p> markers (i.e., numbers of SNPs),
</p>
</li>
<li>
<p> filtered.markers (i.e. filtered SNPs)
</p>
</li>
<li>
<p> pvalue (i.e., p-value).
</p>
</li>
</ul>
<p>Additionally, for  “BT”, there will be “beta” (i.e., gene-level estimates of betas) and “beta.se” (i.e., standard errors of betas).
For “FLM”, there will be the “model” column with the names of the functional models used for each region. Names shortly describe the
functional basis and the number of basis functions used. E.g., "F25" means 25 Fourier basis functions, "B15" means 15 B-spline basis
functions. For “PCA”, there will be the “ncomponents” (the number of the principal components used for each region) and
“explained.variance.fraction” (i.e., the proportion of genetic variance they make up) columns.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>References</h4>

<p>Belonogova NM, Svishcheva GR, Kirichenko AV, Zorkoltseva IV, Tsepilov YA, Axenovich TI (2022).
“sumSTAAR: A flexible framework for gene-based association studies using GWAS summary statistics.”
<em>PLoS Computational Biology</em>, <b>18</b>(6), e1010172.
<a href="https://doi.org/10.1371/journal.pcbi.1010172" class="external-link">doi:10.1371/journal.pcbi.1010172</a>, <a href="http://www.ncbi.nlm.nih.gov/pubmed/35653402" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/35653402</a>.<br><br> Purcell S, Neale B, Todd-Brown K, Thomas L, Ferreira MAR, Bender D, Maller J, Sklar P, de Bakker PIW, Daly MJ, others (2007).
“PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses.”
<em>The American Journal of Human Genetics</em>, <b>81</b>(3), 559–575.
<a href="https://doi.org/10.1086/519795" class="external-link">doi:10.1086/519795</a>.<br><br> Svishcheva GR, Belonogova NM, Zorkoltseva IV, Kirichenko AV, Axenovich TI (2019).
“Gene-based association tests using GWAS summary statistics.”
<em>Bioinformatics</em>, <b>35</b>(19), 3701–3708.
<a href="https://doi.org/10.1093/bioinformatics/btz172" class="external-link">doi:10.1093/bioinformatics/btz172</a>, <a href="http://www.ncbi.nlm.nih.gov/pubmed/30860568" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/30860568</a>.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"XWAS_Summary_Example"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">sumstat</span> <span class="op">&lt;-</span> <span class="va">XWAS_Summary_Example</span></span>
<span><span class="va">ref_data</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">gene_file</span> <span class="op">&lt;-</span> <span class="st">"Xlinkedgenes_hg19.txt"</span></span>
<span><span class="va">gene_range</span> <span class="op">&lt;-</span> <span class="fl">500000</span></span>
<span><span class="va">max_gene</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">gene_approximation</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">beta_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">weights_function</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">geno_variance_weights</span> <span class="op">&lt;-</span> <span class="st">"se.beta"</span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"kuonen"</span></span>
<span><span class="va">acc_devies</span> <span class="op">&lt;-</span> <span class="fl">1e-8</span></span>
<span><span class="va">lim_devies</span> <span class="op">&lt;-</span> <span class="fl">1e+6</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">skato_p_threshold</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="va">mac_threshold</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">4000</span></span>
<span><span class="va">reference_matrix_used</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">regularize_fun</span> <span class="op">&lt;-</span> <span class="st">"LH"</span></span>
<span><span class="va">pca_var_fraction</span> <span class="op">&lt;-</span> <span class="fl">0.85</span></span>
<span><span class="va">flm_basis_function</span> <span class="op">&lt;-</span> <span class="st">"fourier"</span></span>
<span><span class="va">flm_num_basis</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">flm_poly_order</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">flip_genotypes</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">omit_linear_variant</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">kernel_p_method</span> <span class="op">&lt;-</span> <span class="st">"kuonen"</span></span>
<span><span class="va">anno_type</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span><span class="va">GenetestResult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TestXGene.html">TestXGene</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span>, <span class="va">sumstat</span>, <span class="va">gene_file</span>,</span>
<span>    <span class="va">gene_range</span>, <span class="va">score_file</span>, <span class="va">ref_data</span>, <span class="va">max_gene</span>, <span class="va">sample_size</span>,</span>
<span>    genebasedTest <span class="op">=</span> <span class="st">"SKAT"</span>,</span>
<span>    <span class="va">gene_approximation</span>, <span class="va">beta_par</span>, <span class="va">weights_function</span>, <span class="va">geno_variance_weights</span>,</span>
<span>    <span class="va">kernel_p_method</span>, <span class="va">acc_devies</span>, <span class="va">lim_devies</span>, <span class="va">rho</span>, <span class="va">skato_p_threshold</span>, <span class="va">anno_type</span>,</span>
<span>    <span class="va">mac_threshold</span>, <span class="va">reference_matrix_used</span>, <span class="va">regularize_fun</span>, <span class="va">pca_var_fraction</span>,</span>
<span>    <span class="va">flm_basis_function</span>, <span class="va">flm_num_basis</span>, <span class="va">flm_poly_order</span>, <span class="va">flip_genotypes</span>,</span>
<span>    <span class="va">omit_linear_variant</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-14">Function 14<a class="anchor" aria-label="anchor" href="#function-14"></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">MetaGXwas</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No documentation for 'MetaGXwas' in specified packages and libraries</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="function-15">Function 15<a class="anchor" aria-label="anchor" href="#function-15"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">ComputePRS</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>ComputePRS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>ComputePRS: Computing polygenic risk score (PRS)</h3>

<h4>Description</h4>

<p>This function calculates the polygenic risk score, which is the total of allele counts (genotypes) weighted by estimated
effect sizes from genome-wide association studies. It uses C+T filtering techniques. The users could perform clumping procedure
choromosome-wise and genome-wide. Also, the function offers the choice of including several genetic principal components along with
other covariates. Using this function, users have the freedom to experiment with various clumping and thresholding arrangements to
test a wide range of various parameter values.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/ComputePRS.html">ComputePRS</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  <span class="va">summarystat</span>,</span>
<span>  <span class="va">phenofile</span>,</span>
<span>  covarfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  effectsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BETA"</span>, <span class="st">"OR"</span><span class="op">)</span>,</span>
<span>  ldclump <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">LDreference</span>,</span>
<span>  <span class="va">clump_p1</span>,</span>
<span>  <span class="va">clump_p2</span>,</span>
<span>  <span class="va">clump_r2</span>,</span>
<span>  <span class="va">clump_kb</span>,</span>
<span>  byCHR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pthreshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  <span class="va">highLD_regions</span>,</span>
<span>  ld_prunning <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  step_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  r2_threshold <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  nPC <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  pheno_type <span class="op">=</span> <span class="st">"binary"</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the all the input files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is tempdir().</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files for the genotype data i.e., the target data based on which
clumping procedure will be performed. This file needs to be in DataDir. If your target data are small (e.g. N &lt; 500) then you can use
the 1000 Genomes Project samples. Make sure to use the population that most closely reflects represents the base sample.</p>
</td>
</tr>
<tr>
<td><code id="summarystat">summarystat</code></td>
<td>
<p>A dataframe object with GWAS summary statistics.
</p>
<p>The mandatory column headers in this dataframe are:
</p>

<ul>
<li> <p><code>CHR</code>(Chromosome code)
</p>
</li>
<li> <p><code>BP</code>(Basepair position)
</p>
</li>
<li> <p><code>A1</code> (effect allele)
</p>
</li>
<li> <p><code>SNP</code> (i.e., SNP idenitifier)
</p>
</li>
<li> <p><code>BETA</code> or <code>OR</code> (i.e., effect-size or logarithm of odds ratio)
</p>
</li>
<li> <p><code>P</code> (i.e., p-values).
</p>
</li>
</ul>
<p>Special Notes: The first three columns needed to be <code>SNP</code>, <code>A1</code> and <code>BETA</code> or <code>OR</code>.</p>
</td>
</tr>
<tr>
<td><code id="phenofile">phenofile</code></td>
<td>
<p>A character string, specifying the name of the mandatory phenotype file. This is a plain text file with no header line; columns
family ID, individual ID and phenotype columns. For binary trait, the phenotypic value should be coded as 0 or 1, then it will be
recognized as a case-control study (0 for controls and 1 for cases). Missing value should be represented by "-9" or "NA". The
interested phenotype column should be labeled as "Pheno1". This file needs to be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="covarfile">covarfile</code></td>
<td>
<p>A character string, specifying the name of the covariate file which is a plain .text file with no header line; columns are family ID,
individual ID and the covariates. The default is <code>NULL</code>. This file needs to be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="effectsize">effectsize</code></td>
<td>
<p>Boolean value, <code>BETA</code> or <code>OR</code>, specifying the type of the GWAS effectsize. The default is <code>BETA</code>.</p>
</td>
</tr>
<tr>
<td><code id="ldclump">ldclump</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to perform clumping or not.</p>
</td>
</tr>
<tr>
<td><code id="LDreference">LDreference</code></td>
<td>
<p>A character string, specifying the  prefix of the PLINK files of the population reference panel of the same ancestry, and ideally
the one that was used for imputing your target dataset. These files should be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="clump_p1">clump_p1</code></td>
<td>
<p>Numeric value, specifying the significance threshold for index SNPs if <code>ldclump</code> was set to be <code>TRUE</code>. The default is 0.0001.</p>
</td>
</tr>
<tr>
<td><code id="clump_p2">clump_p2</code></td>
<td>
<p>Numeric value, specifying the secondary significance threshold for clumped SNPs if <code>ldclump</code> was set to be <code>TRUE</code>. The default is 0.01</p>
</td>
</tr>
<tr>
<td><code id="clump_r2">clump_r2</code></td>
<td>
<p>Numeric value, specifying the linkage disequilibrium (LD) threshold for clumping if <code>ldclump</code> was set to be <code>TRUE</code>. The default is 0.50.</p>
</td>
</tr>
<tr>
<td><code id="clump_kb">clump_kb</code></td>
<td>
<p>Integer value, specifying the physical distance threshold in base-pair for clumping if <code>ldclump</code> was set to be <code>TRUE</code>. The default is 250.</p>
</td>
</tr>
<tr>
<td><code id="byCHR">byCHR</code></td>
<td>
<p>Boolean value, 'TRUE' or 'FALSE', specifying chromosome-wise clumping procedure if <code>ldclump</code> was set to be <code>TRUE</code>. The default is <code>TRUE</code></p>
</td>
</tr>
<tr>
<td><code id="pthreshold">pthreshold</code></td>
<td>
<p>Numeric vector, containing several p value thresholds to maximize predictive ability of the derived polygenic scores.</p>
</td>
</tr>
<tr>
<td><code id="highLD_regions">highLD_regions</code></td>
<td>
<p>Character string, specifying the .txt file name with known genomic regions with high LD. The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="ld_prunning">ld_prunning</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for LD-based filtering for computing genetic PC as covariates.</p>
</td>
</tr>
<tr>
<td><code id="window_size">window_size</code></td>
<td>
<p>Integer value, specifying a window size in variant count or kilobase for LD-based filtering in computing genetic PC. The default is 50.</p>
</td>
</tr>
<tr>
<td><code id="step_size">step_size</code></td>
<td>
<p>Integer value, specifying a variant count to shift the window at the end of each step for LD filtering in computing genetic PCs. The default is 5.</p>
</td>
</tr>
<tr>
<td><code id="r2_threshold">r2_threshold</code></td>
<td>
<p>Numeric value between 0 to 1 of pairwise <code class="reqn">r^2</code> threshold for LD-based filtering in computing genetic PCs. The default is 0.02.</p>
</td>
</tr>
<tr>
<td><code id="nPC">nPC</code></td>
<td>
<p>Positive integer value, specifying the number of genetic PCs to be included as predictor in the PRS model fit. The default is 6.</p>
</td>
</tr>
<tr>
<td><code id="pheno_type">pheno_type</code></td>
<td>
<p>Boolean value, ‘binary’ or ‘quantitative’, specifying the type of the trait. The default is ‘binary’.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A list object containing a dataframe and a numeric value. The dataframe,PRS, contains four mandatory columns, such as,
IID (i.e., Individual ID), FID (i.e., Family ID), Pheno1 (i.e., the trait for PRS) and Score (i.e., the best PRS).
Other columns of covariates could be there. The numeric value, BestP contains the threshold of
of the best p-value for the best pRS model fit.
</p>
<p>Also, the function produces several plots such as p-value thresholds vs PRS model fit and PRS distribution among male and females.
For case-control data, it shows PRS distribution among cases and controls and ROC curves as well.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Summary_Stat_Ex1"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Example_phenofile"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Example_covarfile"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Example_pthresoldfile"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"highLD_hg19"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">summarystat</span> <span class="op">&lt;-</span> <span class="va">Summary_Stat_Ex1</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">12</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">phenofile</span> <span class="op">&lt;-</span> <span class="va">Example_phenofile</span> <span class="co"># Cannot be NULL</span></span>
<span><span class="co"># The interested phenotype column should be labeled as "Pheno1".</span></span>
<span><span class="va">covarfile</span> <span class="op">&lt;-</span> <span class="va">Example_covarfile</span></span>
<span><span class="va">clump_p1</span> <span class="op">&lt;-</span> <span class="fl">0.0001</span></span>
<span><span class="va">clump_p2</span> <span class="op">&lt;-</span> <span class="fl">0.0001</span></span>
<span><span class="va">clump_kb</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">clump_r2</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">byCHR</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">pthreshold</span> <span class="op">&lt;-</span> <span class="va">Example_pthresoldfile</span><span class="op">$</span><span class="va">Threshold</span></span>
<span><span class="va">ld_prunning</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">highLD_regions</span> <span class="op">&lt;-</span> <span class="va">highLD_hg19</span></span>
<span><span class="va">window_size</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">step_size</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">r2_threshold</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span><span class="va">nPC</span> <span class="op">&lt;-</span> <span class="fl">6</span> <span class="co"># We can incorporate PCs into our PRS analysis to account for population stratification.</span></span>
<span><span class="va">pheno_type</span> <span class="op">&lt;-</span> <span class="st">"binary"</span></span>
<span></span>
<span><span class="va">PRSresult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ComputePRS.html">ComputePRS</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span>, <span class="va">summarystat</span>, <span class="va">phenofile</span>, <span class="va">covarfile</span>,</span>
<span>    effectsize <span class="op">=</span> <span class="st">"BETA"</span>, LDreference <span class="op">=</span> <span class="st">"GXwasR_example"</span>, ldclump <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">clump_p1</span>, <span class="va">clump_p2</span>,</span>
<span>    <span class="va">clump_r2</span>, <span class="va">clump_kb</span>, byCHR <span class="op">=</span> <span class="cn">TRUE</span>, pthreshold <span class="op">=</span> <span class="va">pthreshold</span>, highLD_regions <span class="op">=</span> <span class="va">highLD_regions</span>,</span>
<span>    ld_prunning <span class="op">=</span> <span class="cn">TRUE</span>, window_size <span class="op">=</span> <span class="fl">50</span>, step_size <span class="op">=</span> <span class="fl">5</span>, r2_threshold <span class="op">=</span> <span class="fl">0.02</span>, nPC <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    pheno_type <span class="op">=</span> <span class="st">"binary"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## This table shows 10 samples with phenotype, covariates and a PRS column.</span></span>
<span><span class="va">PRS</span> <span class="op">&lt;-</span> <span class="va">PRSresult</span><span class="op">$</span><span class="va">PRS</span></span>
<span><span class="va">PRS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span>
<span><span class="co">## The best threshold</span></span>
<span><span class="va">BestPvalue</span> <span class="op">&lt;-</span> <span class="va">PRSresult</span><span class="op">$</span><span class="va">BestP</span><span class="op">$</span><span class="va">Threshold</span></span>
<span><span class="va">BestPvalue</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-16">Function 16<a class="anchor" aria-label="anchor" href="#function-16"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">ComputeCorrBT</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No documentation for 'ComputeCorrBT' in specified packages and libraries</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="function-17">Function 17<a class="anchor" aria-label="anchor" href="#function-17"></a>
</h2>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">EstimateHerit</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>EstimateHerit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>EstimateHerit: Computing SNP heritability i.e., the proportion of phenotypic variance explained by SNPs.</h3>

<h4>Description</h4>

<p>This functions performs two types of heritability estimation, (i)GREML:Genomic relatedness matrix (GRM) restricted
maximum likelihood-based method following GCTA (Yang et al. 2011) and (ii)LDSC: LD score regression-based method
following (Bulik-Sullivan et al. 2014; Privé et al. 2020). For the details, please follow the associated paper.
</p>
<p>Prior to using this function, it is recommended to apply QCsnp and QCsample to ensure data quality control.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/EstimateHerit.html">EstimateHerit</a></span><span class="op">(</span></span>
<span>  DataDir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  finput <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  precomputedLD <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indepSNPs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  summarystat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LDSC"</span>, <span class="st">"GREML"</span><span class="op">)</span>,</span>
<span>  computeGRM <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grmfile_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  byCHR <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  r2_LD <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  LDSC_blocks <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  intercept <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chi2_thr1 <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  chi2_thr2 <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  REMLalgo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  nitr <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  cat_covarfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quant_covarfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prevalence <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  partGRM <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  autosome <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Xsome <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nGRM <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  cripticut <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  minMAF <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxMAF <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hg19"</span>, <span class="st">"hg38"</span><span class="op">)</span>,</span>
<span>  PlotIndepSNP <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  IndepSNP_window_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  IndepSNP_step_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  IndepSNP_r2_threshold <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  highLD_regions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plotjpeg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plotname <span class="op">=</span> <span class="st">"Heritability_Plots"</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the all the input files. The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files for the genotype data. This file needs to be in <code>DataDir</code>.
For LDSC model, if the original genotype data is not available, Hapmap 3 or 1000Genome data can be used. If use NULL, then you need
to provide <code>precomputedLD</code> argument. See below.</p>
</td>
</tr>
<tr>
<td><code id="precomputedLD">precomputedLD</code></td>
<td>
<p>A dataframe object as LD matrix with columns: <code>CHR</code>, <code>SNP</code>, <code>BP</code>, <code>ld_size</code>, <code>MAF</code>, <code>ld_score</code>. . The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="indepSNPs">indepSNPs</code></td>
<td>
<p>A dataframe with independent SNP ids with column name "rsid". The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="summarystat">summarystat</code></td>
<td>
<p>A dataframe object with GWAS summary statistics. The mandatory column headers in this dataframe are
</p>

<ul>
<li> <p><code>chr</code> (Chromosome code),
</p>
</li>
<li> <p><code>pos</code> (Basepair position)
</p>
</li>
<li> <p><code>a1</code> (First allele code)
</p>
</li>
<li> <p><code>rsid</code> (i.e., SNP idenitifier)
</p>
</li>
<li> <p><code>beta</code> (i.e., effect-size or logarithm of odds ratio)
</p>
</li>
<li> <p><code>beta_se</code> (i.e., standard error of beta)
</p>
</li>
<li> <p><code>P</code> (i.e., p-values)
</p>
</li>
<li> <p><code>n_eff</code> (i.e., effective sample size)
</p>
</li>
</ul>
<p>For case-control study, effective sample size should be <code class="reqn">4 / (1/&lt;# of cases&gt; + 1/&lt;# of controls&gt;)</code>. The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="ncores">ncores</code></td>
<td>
<p>Integer value, specifying the number of cores to be used for running LDSC model. The default is 2.</p>
</td>
</tr>
<tr>
<td><code id="model">model</code></td>
<td>
<p>Character string, specifying the heritability estimation model. There are two options, “GREML” or “LDSC”. The default is “GREML”.
</p>
<p>Note: argument For LDSC, DataDir and finput can be <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="computeGRM">computeGRM</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to compute GRM matrices or not. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="grmfile_name">grmfile_name</code></td>
<td>
<p>A string of characters specifying the prefix of autosomal .grm.bin file. Users need to provide separate GRM files
for autosomes and X chromosome in <code>ResultDir</code>.
</p>
<p>The X chromosomal GRM file should have "x" added in the autosomal prefix as file name. For instance, if autosomal file
is "ABC.grm.bin", then X chromosomal file should be "xABC.grm.bim".
</p>
<p>If you are providing chromosome-wise GRMs, then the prefix should add "ChrNumber_" at the start of the prefix like,
"Chr1_ABC.grm.bin". The default is NULL.</p>
</td>
</tr>
<tr>
<td><code id="byCHR">byCHR</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether the analysis will be performed chromosome wise or not. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="r2_LD">r2_LD</code></td>
<td>
<p>Numeric value, specifying the LD threshold for clumping in LDSC model. The default is 0.</p>
</td>
</tr>
<tr>
<td><code id="LDSC_blocks">LDSC_blocks</code></td>
<td>
<p>Integer value, specifying the block size for performing jackknife variance estimator in LDSC model following (Privé et al. 2020).
The default is 200.</p>
</td>
</tr>
<tr>
<td><code id="intercept">intercept</code></td>
<td>
<p>Numeric value to constrain the intercept to some value (e.g. 1) in LDSC regression. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="chi2_thr1">chi2_thr1</code></td>
<td>
<p>Numeric value for threshold on chi2 in step 1 of LDSC regression. Default is 30.</p>
</td>
</tr>
<tr>
<td><code id="chi2_thr2">chi2_thr2</code></td>
<td>
<p>Numeric value for threshold on chi2 in step 2. Default is <code>Inf</code> (none).</p>
</td>
</tr>
<tr>
<td><code id="REMLalgo">REMLalgo</code></td>
<td>
<p>Integer value of 0, 1 or 2, specifying the algorithm to run REML iterations, 0 for average information (AI), 1 for Fisher-scoring and
2 for EM. The default option is 0, i.e. AI-REML (Yang et al. 2011).</p>
</td>
</tr>
<tr>
<td><code id="nitr">nitr</code></td>
<td>
<p>Integer value, specifying the number of iterations for performing the REML. The default is 100.</p>
</td>
</tr>
<tr>
<td><code id="cat_covarfile">cat_covarfile</code></td>
<td>
<p>A character string, specifying the name of the categorical covariate file which is a plain text file with no header line; columns
are family ID, individual ID and discrete covariates. The default is <code>NULL</code>. This file needs to be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="quant_covarfile">quant_covarfile</code></td>
<td>
<p>A character string, specifying the name of the quantitative covariate file which is a plain text file with no header line;
columns are family ID, individual ID and continuous covariates. The default is <code>NULL</code>. This file needs to be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="prevalence">prevalence</code></td>
<td>
<p>Numeric value, specifying the disease prevalence. The default is <code>NULL</code>.
</p>
<p>Note: for the continuous trait value, users should use the default.</p>
</td>
</tr>
<tr>
<td><code id="partGRM">partGRM</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether the GRM will be partitioned into n parts (by row) in GREML model. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="autosome">autosome</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether estimate of heritability will be done for autosomes or not. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="Xsome">Xsome</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether estimate of heritability will be done for X chromosome or not. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="nGRM">nGRM</code></td>
<td>
<p>Integer value, specifying the number of the partision of the GRM in GREML model. The default is 3.</p>
</td>
</tr>
<tr>
<td><code id="cripticut">cripticut</code></td>
<td>
<p>Numeric value, specifying the threshold to create a new GRM of "unrelated" individuals in GREML model. The default is arbitrary chosen
as 0.025 following (Yang et al. 2011).</p>
</td>
</tr>
<tr>
<td><code id="minMAF">minMAF</code></td>
<td>
<p>Positive numeric value (0,1), specifying the minimum threshold for the MAF filter of the SNPs in the GREML model. This value cannot be
greater than <code>maxMAF</code> parameter. The default is <code>NULL</code>. For <code>NULL</code>, maximum MAF value of the genotype data will be computed and printed
on the plot.</p>
</td>
</tr>
<tr>
<td><code id="maxMAF">maxMAF</code></td>
<td>
<p>Positive numeric value (0,1), specifying the maximum threshold for the MAF filter of the SNPs in the GREML model. This value cannot be less
than <code>minMAF</code> parameter. The default is <code>NULL</code>. For <code>NULL</code>, minimum MAF value of the genotype data will be computed and printed on the plot.</p>
</td>
</tr>
<tr>
<td><code id="hg">hg</code></td>
<td>
<p>Boolean value, specifying the genome built, “hg19” or “hg38” to use chromosome length from UCSC genome browser and getting genes and proteins
according to this built. The default is “hg19”.</p>
</td>
</tr>
<tr>
<td><code id="PlotIndepSNP">PlotIndepSNP</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to use independent SNPs i.e., chromosome-wise LD pruned SNPs in the plots or not.
The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="IndepSNP_window_size">IndepSNP_window_size</code></td>
<td>
<p>Integer value, specifying a window size in variant count or kilobase for LD-based filtering. The default is 50.</p>
</td>
</tr>
<tr>
<td><code id="IndepSNP_step_size">IndepSNP_step_size</code></td>
<td>
<p>Integer value, specifying a variant count to shift the window at the end of each step for LD filtering for pruned SNPs in the plots.
The default is 5.</p>
</td>
</tr>
<tr>
<td><code id="IndepSNP_r2_threshold">IndepSNP_r2_threshold</code></td>
<td>
<p>Numeric value between 0 to 1 of pairwise <code class="reqn">r^2</code> threshold for LD-based filtering for pruned SNPs in the plots. The default is 0.02.</p>
</td>
</tr>
<tr>
<td><code id="highLD_regions">highLD_regions</code></td>
<td>
<p>Character string, specifying the .txt file name with genomic regions with high LD for using in finding pruned SNPs in the plots.
This file needs to be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="plotjpeg">plotjpeg</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to save the plots in jpeg file in <code>ResultDir</code>. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="plotname">plotname</code></td>
<td>
<p>String of character value specifying the name of the jpeg file with the plots. The deafult is "Heritability_Plots".</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A dataframe with maximum eight columns for GREML (here, three columns if running genome-wide) and ten columns for LDSC model if byCHR is <code>TRUE</code>.
The columns, such as, "chromosome"(i.e., chromosome code),"snp_proportion" (i.e.,chromosome-wise SNP propotion)", "no.of.genes" (i.e., number of genes per chromosome),
"no.of.proteins" (i.e., number of genes per chromosome),"size_mb" (i.e., chromosome length), "Source" (i.e., source of heritability),
"Variance" (i.e., estimated heritability), and "SE" (i.e., standard error of the estimated heritability) are common for both GREML and LDSC model.
The column, "Intercept" (i.e., LDSC regression intercept) and "Int_SE" (i.e., standard error of the intercept) will be two extra columns for LDSC models.
Source column will have rows, such as <code>V(1)</code> (i.e., name of genetic variance), <code>V(e)</code> (i.e., residual variance), <code>V(p)</code> (i.e., phenotypic variance), <code>V(1)/Vp</code> (i.e.,
ratio of genetic variance to phenotypic variance), and <code>V(1)/Vp_L</code> (i.e., ratio of genetic variance to phenotypic variance in liability scale for binary phenotypes).
If <code>byCHR</code> is <code>FALSE</code>, then the first five columns will not be reported in the dataframe.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>References</h4>

<p>Bulik-Sullivan B, Finucane HK, Anttila V, Gusev A, Day FR, Loh P, Consortium R, Consortium PG, of the Wellcome Trust Case Control Consortium GCfAN, Perry JRB, Patterson N, Robinson EB, Daly MJ, Price AL, Neale BM (2014).
“LD score regression distinguishes confounding from polygenicity in genome-wide association studies.”
<em>Nature Genetics</em>, <b>47</b>, 291–295.<br><br> Privé F, Arbel J, Vilhjálmsson BJ (2020).
“LDpred2: better, faster, stronger.”
<em>Bioinformatics</em>, <b>36</b>(22-23), 5424–5431.
<a href="https://doi.org/10.1093/bioinformatics/btaa1029" class="external-link">doi:10.1093/bioinformatics/btaa1029</a>.<br><br> Yang J, Lee SH, Goddard ME, Visscher PM (2011).
“GCTA: a tool for Genome-wide Complex Trait Analysis.”
<em>American Journal of Human Genetics</em>, <b>88</b>(1), 76–82.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Summary_Stat_Ex1"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"highLD_hg19"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">precomputedLD</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">test.sumstats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">Summary_Stat_Ex1</span><span class="op">[</span><span class="va">Summary_Stat_Ex1</span><span class="op">$</span><span class="va">TEST</span> <span class="op">==</span> <span class="st">"ADD"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">test.sumstats</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="st">"rsid"</span>, <span class="st">"pos"</span>, <span class="st">"a1"</span>, <span class="st">"n_eff"</span>, <span class="st">"beta"</span>, <span class="st">"beta_se"</span><span class="op">)</span></span>
<span><span class="va">summarystat</span> <span class="op">&lt;-</span> <span class="va">test.sumstats</span></span>
<span><span class="va">ncores</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"GREML"</span></span>
<span><span class="va">byCHR</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">r2_LD</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">LDSC_blocks</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">REMLalgo</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">nitr</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">cat_covarfile</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">quant_covarfile</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">prevalence</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">partGRM</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">autosome</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">Xsome</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">nGRM</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">cripticut</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">minMAF</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">maxMAF</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">hg</span> <span class="op">&lt;-</span> <span class="st">"hg19"</span></span>
<span><span class="va">PlotIndepSNP</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">IndepSNP_window_size</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">IndepSNP_step_size</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">IndepSNP_r2_threshold</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span><span class="va">highLD_regions</span> <span class="op">&lt;-</span> <span class="va">highLD_hg19</span></span>
<span><span class="va">H2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/EstimateHerit.html">EstimateHerit</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>, finput <span class="op">=</span> <span class="va">finput</span>,</span>
<span>    summarystat <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">ncores</span>, model <span class="op">=</span> <span class="st">"GREML"</span>, byCHR <span class="op">=</span> <span class="cn">TRUE</span>, r2_LD <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    LDSC_blocks <span class="op">=</span> <span class="fl">20</span>, REMLalgo <span class="op">=</span> <span class="fl">0</span>, nitr <span class="op">=</span> <span class="fl">100</span>, cat_covarfile <span class="op">=</span> <span class="cn">NULL</span>, quant_covarfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    prevalence <span class="op">=</span> <span class="fl">0.01</span>, partGRM <span class="op">=</span> <span class="cn">FALSE</span>, autosome <span class="op">=</span> <span class="cn">TRUE</span>, Xsome <span class="op">=</span> <span class="cn">TRUE</span>, nGRM <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    cripticut <span class="op">=</span> <span class="fl">0.025</span>, minMAF <span class="op">=</span> <span class="cn">NULL</span>, maxMAF <span class="op">=</span> <span class="cn">NULL</span>, hg <span class="op">=</span> <span class="st">"hg19"</span>, PlotIndepSNP <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    IndepSNP_window_size <span class="op">=</span> <span class="fl">50</span>, IndepSNP_step_size <span class="op">=</span> <span class="fl">5</span>, IndepSNP_r2_threshold <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>    highLD_regions <span class="op">=</span> <span class="va">highLD_hg19</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-18">Function 18<a class="anchor" aria-label="anchor" href="#function-18"></a>
</h2>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">SexRegress</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>SexRegress</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>SexRegress: Performing linear regression analysis with quantitative response variable.</h3>

<h4>Description</h4>

<p>This function could be used to check association of two variables. For instance, PRS with sex.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/SexRegress.html">SexRegress</a></span><span class="op">(</span><span class="va">fdata</span>, <span class="va">regressor_index</span>, <span class="va">response_index</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="fdata">fdata</code></td>
<td>
<p>R dataframe object. The column with header <code>response</code> should contain the response variable. All other column are the regressor.</p>
</td>
</tr>
<tr>
<td><code id="regressor_index">regressor_index</code></td>
<td>
<p>Integer value, specifying the column number of the main regressor variable.</p>
</td>
</tr>
<tr>
<td><code id="response_index">response_index</code></td>
<td>
<p>Integer value, specifying the column number of the response variable.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>Numeric value containing the regression estimate ("Estimate"), standard error ("Std. Error"), statistics ("t value") and
p-value (<code class="reqn">Pr(&gt;|t|)</code>)
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Regression_Ex"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">fdata</span> <span class="op">&lt;-</span> <span class="va">Regression_Ex</span></span>
<span><span class="va">fdata</span><span class="op">$</span><span class="va">SEX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">fdata</span><span class="op">$</span><span class="va">SEX</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">response_index</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">regressor_index</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SexRegress.html">SexRegress</a></span><span class="op">(</span><span class="va">fdata</span>, <span class="va">regressor_index</span>, <span class="va">response_index</span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-19">Function 19<a class="anchor" aria-label="anchor" href="#function-19"></a>
</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">FilterPlinkSample</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>FilterPlinkSample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>FilterPlinkSample: Making PLINK files with desired samples.</h3>

<h4>Description</h4>

<p>This function prepares PLINK binary files with the desired samples.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/FilterPlinkSample.html">FilterPlinkSample</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  <span class="va">ResultDir</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  foutput <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter_sample <span class="op">=</span> <span class="st">"cases"</span>,</span>
<span>  keep_remove_sample_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>Character string for the file path of the all input files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>character string for the file path where the output PLINK files will be stored.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="filter_sample">filter_sample</code></td>
<td>
<p>Character string, specifying the sample type to be retained. The choices are, "cases", "controls", "males" and "females".
The default is "cases".</p>
</td>
</tr>
<tr>
<td><code id="keep_remove_sample_file">keep_remove_sample_file</code></td>
<td>
<p>Character string, specifying the prefix of a space/tab-delimited text file with no header. For the samples that we want
to keep or remove, the family IDs should be in the first column and within-family IDs in the second column. This file
needs to be in the <code>DataDir</code>. The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="keep">keep</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for specifying desired samples to keep or remove. The default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p><code>NULL</code>
</p>
<p>The output plink files with passed samples will be saved in ResultDir.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"casesPlink"</span></span>
<span><span class="va">filter_sample</span> <span class="op">&lt;-</span> <span class="st">"cases"</span></span>
<span><span class="va">keep_remove_sample_file</span> <span class="op">&lt;-</span> <span class="st">"samples_example"</span></span>
<span><span class="va">keep</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/FilterPlinkSample.html">FilterPlinkSample</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>,</span>
<span>    finput <span class="op">=</span> <span class="va">finput</span>, foutput <span class="op">=</span> <span class="va">foutput</span>, keep_remove_sample_file <span class="op">=</span> <span class="va">keep_remove_sample_file</span>,</span>
<span>    keep <span class="op">=</span> <span class="va">keep</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-20">Function 20<a class="anchor" aria-label="anchor" href="#function-20"></a>
</h2>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">ComputeGeneticPC</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>ComputeGeneticPC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>ComputeGeneticPC: Computing principal components from genetic relationship matrix</h3>

<h4>Description</h4>

<p>This function performs principal components analysis (PCA) based on the variance-standardized relationship
matrix (Purcell et al. 2007).
</p>
<p>Top principal components are generally used as covariates in association analysis regressions to help correct for
population stratification
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/ComputeGeneticPC.html">ComputeGeneticPC</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  countPC <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  plotPC <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  highLD_regions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ld_prunning <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  step_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  r2_threshold <span class="op">=</span> <span class="fl">0.02</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files. This file needs to be in <code>DataDir.</code></p>
</td>
</tr>
<tr>
<td><code id="countPC">countPC</code></td>
<td>
<p>Integer value, specifying the number of principal components. The default is 10.</p>
</td>
</tr>
<tr>
<td><code id="plotPC">plotPC</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to plot the first two PCs.</p>
</td>
</tr>
<tr>
<td><code id="highLD_regions">highLD_regions</code></td>
<td>
<p>A R dataframe with genomic regions with high LD for using in finding pruned SNPs in the plots. The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="ld_prunning">ld_prunning</code></td>
<td>
<p>Numeric value between 0 to 1 of pairwise <code class="reqn">r^2</code> threshold for LD-based filtering for pruned SNPs in the plots.
The default is 0.02.</p>
</td>
</tr>
<tr>
<td><code id="window_size">window_size</code></td>
<td>
<p>Integer value, specifying a window size in variant count or kilobase for LD-based filtering. The default is 50.</p>
</td>
</tr>
<tr>
<td><code id="step_size">step_size</code></td>
<td>
<p>Integer value, specifying a variant count to shift the window at the end of each step for LD filtering for pruned SNPs
in the plots. The default is 5.</p>
</td>
</tr>
<tr>
<td><code id="r2_threshold">r2_threshold</code></td>
<td>
<p>Numeric value between 0 to 1 of pairwise <code class="reqn">r^2</code> threshold for LD-based filtering for pruned SNPs in the plots.
The default is 0.02.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A dataframe with genetic principal components. The first two columns are IID (i.e., Individual Id) and
FID (i.e., Family ID). The other columns are PCs.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>References</h4>

<p>Purcell S, Neale B, Todd-Brown K, Thomas L, Ferreira MAR, Bender D, Maller J, Sklar P, de Bakker PIW, Daly MJ, others (2007).
“PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses.”
<em>The American Journal of Human Genetics</em>, <b>81</b>(3), 559–575.
<a href="https://doi.org/10.1086/519795" class="external-link">doi:10.1086/519795</a>.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"highLD_hg19"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">highLD_regions</span> <span class="op">&lt;-</span> <span class="va">highLD_hg19</span></span>
<span><span class="va">ld_prunning</span> <span class="op">&lt;-</span> <span class="st">"TRUE"</span></span>
<span><span class="va">window_size</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">step_size</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">r2_threshold</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span><span class="va">countPC</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="co">## Genetic PC</span></span>
<span><span class="va">GP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ComputeGeneticPC.html">ComputeGeneticPC</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>,</span>
<span>    finput <span class="op">=</span> <span class="va">finput</span>, highLD_regions <span class="op">=</span> <span class="va">highLD_hg19</span>, countPC <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-21">Function 21<a class="anchor" aria-label="anchor" href="#function-21"></a>
</h2>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">ClumpLD</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>ClumpLD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>ClumpLD: Clumping SNPs using linkage disequilibrium between SNPs</h3>

<h4>Description</h4>

<p>This function, which is based on empirical estimations of linkage disequilibrium between SNPs, groups the SNP-based results
across one or more datasets or analysis. This approach can be used in two basic scenarios: (i) To summarize the top X single
SNP findings from a genome-wide scan as fewer clusters of connected SNPs (i.e., to assess how many independent loci are
associated). (ii) To give researchers a simple approach to merge sets of data from multiple studies when those studies may
have used various marker sets for genotyping.
</p>
<p>The clumping process begins with the index SNPs that are significant at threshold p1 and have not yet been clumped. It then
creates clumps of all additional SNPs that are within a specified kb of the index SNP and that are in linkage disequilibrium
with the index SNP based on an r-squared threshold. Following that, these SNPs are filtered based on the outcome for that SNP.
As this method is greedy (Purcell et al. 2007), each SNP will, at most, only appear in one clump. The P value and
ALLELES would always, at random, be chosen from the first input file if the same SNP appeared in several input files in SNPdata
argument. Instead of the best p-value, the function refer to the SNP that has the strongest LD to the index as the best proxy.
Based on the genotype data, the SNP with the highest LD will be the same for all input files.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/ClumpLD.html">ClumpLD</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  <span class="va">SNPdata</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">clump_p1</span>,</span>
<span>  <span class="va">clump_p2</span>,</span>
<span>  <span class="va">clump_r2</span>,</span>
<span>  <span class="va">clump_kb</span>,</span>
<span>  byCHR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clump_best <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clump_index_first <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files which will be used to calculate linkage disequilibrium
between the SNPs. This actual genotype data may or may not be the same dataset that was used to generate the summary statistics.
This file needs to be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="SNPdata">SNPdata</code></td>
<td>
<p>A list of R dataframes containing a single or multiple summary statistics with SNP and P (i.e., p-values) in mandatory column
headers. Other columns could be present.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="clump_p1">clump_p1</code></td>
<td>
<p>Numeric value, specifying the significance threshold for index SNPs. The default is 0.0001.</p>
</td>
</tr>
<tr>
<td><code id="clump_p2">clump_p2</code></td>
<td>
<p>Numeric value, specifying the secondary significance threshold for clumped SNPs. The default is 0.01</p>
</td>
</tr>
<tr>
<td><code id="clump_r2">clump_r2</code></td>
<td>
<p>Numeric value, specifying the LD threshold for clumping. The default is 0.50.</p>
</td>
</tr>
<tr>
<td><code id="clump_kb">clump_kb</code></td>
<td>
<p>Integer value, specifying the physical distance threshold in base-pair for clumping. The default is 250.</p>
</td>
</tr>
<tr>
<td><code id="byCHR">byCHR</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to perform the clumping chromosome-wise.</p>
</td>
</tr>
<tr>
<td><code id="clump_best">clump_best</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to select and output the best SNP from each clump. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="clump_index_first">clump_index_first</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to force the index SNP to appear first in each clump. This option should
typically be <code>TRUE</code> if clump_best is <code>TRUE.</code> Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>A list with two dataframes.
</p>
<p>BestClump: a dataframe with eight columns showing the single best proxy SNP for each index SNP with
coulmns "INDEX"(Index SNP identifier), "PSNP"(Best proxy SNP), "RSQ LD"(r-squared) between index and proxy,
"KB"(Physical distance between index and proxy), P(p-value for proxy SNP), "ALLELES"(The associated haplotypes for the index and proxy SNP),
and "F"(Which file used for clumping from which this result came from).
</p>
<p>AllClump: a dataframe with eight columns providing a detailed summary
of each clump identified by PLINK. It includes "INDEX_SNP" (the identifier for the index SNP that represents the clump), "SNP"
(the SNP being reported, which for the index SNP is the same as INDEX_SNP), "DISTANCE" (the physical distance in base pairs between the index
SNP and the reported SNP, with 0.0 indicating the index itself), "RSQ" (the r-squared value showing the degree of linkage disequilibrium between
the index SNP and the SNP in the clump), "ALLELES" (the allele information, which in some cases may appear misaligned if the data isn’t formatted
as expected), "F" (a statistic or indicator related to the association test, which may be NA when not applicable), "P" (the p-value for the
association test of the SNP), and "CHR" (the chromosome on which the SNP is located).
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>References</h4>

<p>Purcell S, Neale B, Todd-Brown K, Thomas L, Ferreira MAR, Bender D, Maller J, Sklar P, de Bakker PIW, Daly MJ, others (2007).
“PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses.”
<em>The American Journal of Human Genetics</em>, <b>81</b>(3), 559–575.
<a href="https://doi.org/10.1086/519795" class="external-link">doi:10.1086/519795</a>.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Summary_Stat_Ex1"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Summary_Stat_Ex2"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">SNPdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Summary_Stat_Ex1</span>, <span class="va">Summary_Stat_Ex2</span><span class="op">)</span></span>
<span><span class="va">clump_p1</span> <span class="op">&lt;-</span> <span class="fl">0.0001</span></span>
<span><span class="va">clump_p2</span> <span class="op">&lt;-</span> <span class="fl">0.001</span></span>
<span><span class="va">clump_r2</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">clump_kb</span> <span class="op">&lt;-</span> <span class="fl">250</span></span>
<span><span class="va">byCHR</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">clumpedResult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ClumpLD.html">ClumpLD</a></span><span class="op">(</span></span>
<span>    <span class="va">DataDir</span>, <span class="va">finput</span>, <span class="va">SNPdata</span>, <span class="va">ResultDir</span>, <span class="va">clump_p1</span>,</span>
<span>    <span class="va">clump_p2</span>, <span class="va">clump_r2</span>, <span class="va">clump_kb</span>, <span class="va">byCHR</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-22">Function 22<a class="anchor" aria-label="anchor" href="#function-22"></a>
</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">GetMFPlink</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>GetMFPlink</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>GetMFPlink: Getting male and female PLINK binary files.</h3>

<h4>Description</h4>

<p>This function prepares separate male and female PLINK binary files from combined PLINK files.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/GetMFPlink.html">GetMFPlink</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  <span class="va">foutput</span>,</span>
<span>  <span class="va">sex</span>,</span>
<span>  xplink <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  autoplink <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>Character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>Character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="sex">sex</code></td>
<td>
<p>Boolean value, 'males' or 'females', specifying output plink binary files with male or female samples.</p>
</td>
</tr>
<tr>
<td><code id="xplink">xplink</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying output plink binary files with only X chromosome or not. Default is <code>FALSE.</code></p>
</td>
</tr>
<tr>
<td><code id="autoplink">autoplink</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying output plink binary files with only autosome or not. Default is <code>FALSE.</code></p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>None
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"Test_output"</span></span>
<span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="st">"females"</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetMFPlink.html">GetMFPlink</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>,</span>
<span>    finput <span class="op">=</span> <span class="va">finput</span>, foutput <span class="op">=</span> <span class="va">foutput</span>, sex <span class="op">=</span> <span class="va">sex</span>,</span>
<span>    xplink <span class="op">=</span> <span class="cn">FALSE</span>, autoplink <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-23">Function 23<a class="anchor" aria-label="anchor" href="#function-23"></a>
</h2>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">plinkVCF</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>plinkVCF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>plinkVCF: Converting VCF files to plink binary files and vice-versa.</h3>

<h4>Description</h4>

<p>This function performs the conversion between VCF files to plink binary formats.
</p>
<p>For VCF to plink files conversion, if you do not specify any FAM file when you are converting from VCF to plink
format, then plink will just create a 'dummy' FAM file with the same name as your dataset with missing phenotypes
and missing sex.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/plinkVCF.html">plinkVCF</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  <span class="va">foutput</span>,</span>
<span>  VtoP <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  PtoV <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Famfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  PVbyCHR <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input plink binary files and all other input files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input plink binary files or vcf files. This file needs to be in <code>DataDir</code>.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output plink binary files if filtering option for the SNPs is chosen.
The default is "FALSE".</p>
</td>
</tr>
<tr>
<td><code id="VtoP">VtoP</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying the conversion of VCF files to plink binary files or not. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="PtoV">PtoV</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying the conversion of plink binary files to VCF  files or not. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr>
<td><code id="Famfile">Famfile</code></td>
<td>
<p>Character string, specifying the name of the original .fam file if VtoP was set to be <code>TRUE</code>. This file needs to be in <code>DataDir</code>.
The default is <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td><code id="PVbyCHR">PVbyCHR</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code> specifying to do the plink to vcf conversion chromosome-wise or not. The default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p><code>NULL</code>
</p>
<p>The output files will be saved in <code>ResultDir</code>.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span> <span class="co"># Plink file</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example1"</span></span>
<span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">PtoV</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">VtoP</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">Famfile</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">PVbyCHR</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="fu"><a href="../reference/plinkVCF.html">plinkVCF</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span>, <span class="va">foutput</span>, <span class="va">VtoP</span>, <span class="va">PtoV</span>, <span class="va">Famfile</span>, <span class="va">PVbyCHR</span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-24">Function 24<a class="anchor" aria-label="anchor" href="#function-24"></a>
</h2>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">MergeRegion</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>MergeRegion</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>MergeRegion: Merging two sets of plink binary files.</h3>

<h4>Description</h4>

<p>This function combines the two genotype datasets based on either common SNPs or all the SNPs between them.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/MergeRegion.html">MergeRegion</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  <span class="va">ResultDir</span>,</span>
<span>  <span class="va">finput1</span>,</span>
<span>  <span class="va">finput2</span>,</span>
<span>  <span class="va">foutput</span>,</span>
<span>  use_common_snps <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input plink binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is tempdir().</p>
</td>
</tr>
<tr>
<td><code id="finput1">finput1</code></td>
<td>
<p>Character string, specifying the prefix of the first input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="finput2">finput2</code></td>
<td>
<p>Character string, specifying the prefix of the first input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output PLINK binary files if filtering option for the SNPs is chosen. The default is "FALSE".</p>
</td>
</tr>
<tr>
<td><code id="use_common_snps">use_common_snps</code></td>
<td>
<p>Boolean value, TRUE or FALSE, specifying to use common SNPs for merging or to use all the SNPs.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>NULL
</p>
<p>The output plink files will be saved in ResultDir.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput1</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">finput2</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example_imputed"</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"Test_output"</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MergeRegion.html">MergeRegion</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput1</span>, <span class="va">finput2</span>, <span class="va">foutput</span>, use_common_snps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-25">Function 25<a class="anchor" aria-label="anchor" href="#function-25"></a>
</h2>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">FilterAllele</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>FilterAllele</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>FilterAllele: Filtering out the multi-allelic variants</h3>

<h4>Description</h4>

<p>This function filters out the multi-allelic SNPs from the input dataset.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/FilterAllele.html">FilterAllele</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span>, <span class="va">foutput</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output PLINK binary files. If multi-allelic variants are present,
this file will be produced after filtering out these variants.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p><code>NULL</code>. After multi-allelic variant filtering, the filtered plink files with only biallelic SNPs will be saved in <code>ResultDir</code>.
</p>


<h4>Author(s)</h4>

<p>Banabithi Bose
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"Filter_Test"</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FilterAllele.html">FilterAllele</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span>, <span class="va">foutput</span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-26">Function 26<a class="anchor" aria-label="anchor" href="#function-26"></a>
</h2>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">PlinkSummary</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>PlinkSummary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>PlinkSummary: Summary of plink format genotype dataset</h3>

<h4>Description</h4>

<p>PlinkSummary: Summary of plink format genotype dataset
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/PlinkSummary.html">PlinkSummary</a></span><span class="op">(</span><span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">finput</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path of the plink program to be set up.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files. This file needs to be in DataDir.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>This function is called for its side effect: printing summary statistics to the console. It returns <code>NULL</code> invisibly.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlinkSummary.html">PlinkSummary</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span><span class="op">)</span></span>
<span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-27">Function 27<a class="anchor" aria-label="anchor" href="#function-27"></a>
</h2>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">FilterSNP</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>FilterSNP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>FilterSNP: Filter out SNPs.</h3>

<h4>Description</h4>

<p>FilterSNP: Filter out SNPs.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/FilterSNP.html">FilterSNP</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span>, <span class="va">foutput</span>, <span class="va">SNPvec</span>, extract <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="foutput">foutput</code></td>
<td>
<p>Character string, specifying the prefix of the output PLINK binary files if the filtering option for the SNPs is chosen.
The default is "FALSE".</p>
</td>
</tr>
<tr>
<td><code id="SNPvec">SNPvec</code></td>
<td>
<p>R dataframe with SNP names to be excluded.</p>
</td>
</tr>
<tr>
<td><code id="extract">extract</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to extract the snps or discard the snps. The default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p><code>NULL</code>. The filtered file will be saved in <code>ResultDir</code>.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span></span>
<span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">SNPvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rs6529954"</span>, <span class="st">"rs12858640"</span>, <span class="st">"rs5962098"</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"Filter_Test"</span></span>
<span><span class="fu"><a href="../reference/FilterSNP.html">FilterSNP</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span>, <span class="va">foutput</span>, SNPvec <span class="op">=</span> <span class="va">SNPvec</span>, extract <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-28">Function 28<a class="anchor" aria-label="anchor" href="#function-28"></a>
</h2>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">DummyCovar</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>DummyCovar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>DummyCovar: Recode a categorical variable to a set of binary dummy variables.</h3>

<h4>Description</h4>

<p>When dealing with categorical variables in genetic analysis using, a common approach is to convert these into dummy variables
for proper analysis (Purcell et al. 2007). This function creates K-1 new dummy variables for a variable with K categories.
One level is automatically excluded from the dummy variables which serves as the reference category for subsequent analyses. This setup
implicitly sets the excluded that category as the baseline against which other categories are compared.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/DummyCovar.html">DummyCovar</a></span><span class="op">(</span><span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">DataDir</span>, <span class="va">bfile</span>, <span class="va">incovar</span>, <span class="va">outcovar</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>A character string for the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p>
</td>
</tr>
<tr>
<td><code id="bfile">bfile</code></td>
<td>
<p>Character string, specifying the prefix of the input PLINK binary files for which covariate file will be generated.</p>
</td>
</tr>
<tr>
<td><code id="incovar">incovar</code></td>
<td>
<p>Character string, specifying the prefix of the input covariate file. First two columns will be, FID (i.e., Family ID) and IID (i.e.,
Sample ID) and rest of the columns are covariates.</p>
</td>
</tr>
<tr>
<td><code id="outcovar">outcovar</code></td>
<td>
<p>Character string, specifying the prefix of the Output covariate file</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>R dataframe object with covariates
</p>


<h4>References</h4>

<p>Purcell S, Neale B, Todd-Brown K, Thomas L, Ferreira MAR, Bender D, Maller J, Sklar P, de Bakker PIW, Daly MJ, others (2007).
“PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses.”
<em>The American Journal of Human Genetics</em>, <b>81</b>(3), 559–575.
<a href="https://doi.org/10.1086/519795" class="external-link">doi:10.1086/519795</a>.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bfile</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">incovar</span> <span class="op">&lt;-</span> <span class="st">"covarfile_w_pc_age.txt"</span></span>
<span><span class="va">outcovar</span> <span class="op">&lt;-</span> <span class="st">"dummycovarfile"</span></span>
<span><span class="va">dummy_covars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DummyCovar.html">DummyCovar</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>,</span>
<span>    bfile <span class="op">=</span> <span class="va">bfile</span>, incovar <span class="op">=</span> <span class="va">incovar</span>,</span>
<span>    outcovar <span class="op">=</span> <span class="va">outcovar</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-29">Function 29<a class="anchor" aria-label="anchor" href="#function-29"></a>
</h2>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">GXWASmiami</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>GXWASmiami</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>Miami plot</h3>

<h4>Description</h4>

<p>This function generates Miami plots for GWAS and XWAS.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/GXWASmiami.html">GXWASmiami</a></span><span class="op">(</span></span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">FemaleWAS</span>,</span>
<span>  <span class="va">MaleWAS</span>,</span>
<span>  snp_pval <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  Xchr <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>Character string for the folder path where the outputs will be saved.</p>
</td>
</tr>
<tr>
<td><code id="FemaleWAS">FemaleWAS</code></td>
<td>
<p>R dataframe of summary statistics of GWAS or XWAS of female samples with four columns, SNP(Variant),
CHR(Chromosome number), POS(Base pair position) and pvalue(P-value of the test). This can be generated
by running FM01comb or FM02comb model with GXWAS function.</p>
</td>
</tr>
<tr>
<td><code id="MaleWAS">MaleWAS</code></td>
<td>
<p>R dataframe of summary statistics of GWAS or XWAS of male samples with four columns, SNP(Variant),
CHR(Chromosome number), POS(Base pair position) and pvalue(P-value of the test). This can be generated
by running FM01comb or FM02comb model with GXWAS function.</p>
</td>
</tr>
<tr>
<td><code id="snp_pval">snp_pval</code></td>
<td>
<p>Numeric value as p-value threshold for annotation. SNPs below this p-value will be annotated on the plot.
The default is 1e-08.</p>
</td>
</tr>
<tr>
<td><code id="Xchr">Xchr</code></td>
<td>
<p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to generate Miami plot for stratified XWAS or not.
The default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>Invisibly returns <code>NULL</code>. Generates and saves Miami plots as a side effect.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Ffile"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Mfile"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">FemaleWAS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">Ffile</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="st">"CHR"</span>, <span class="st">"BP"</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">FemaleWAS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="st">"CHR"</span>, <span class="st">"POS"</span>, <span class="st">"pvalue"</span><span class="op">)</span></span>
<span><span class="va">MaleWAS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">Mfile</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="st">"CHR"</span>, <span class="st">"BP"</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">MaleWAS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="st">"CHR"</span>, <span class="st">"POS"</span>, <span class="st">"pvalue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/GXWASmiami.html">GXWASmiami</a></span><span class="op">(</span>FemaleWAS <span class="op">=</span> <span class="va">FemaleWAS</span>, MaleWAS <span class="op">=</span> <span class="va">MaleWAS</span>, snp_pval <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-30">Function 30<a class="anchor" aria-label="anchor" href="#function-30"></a>
</h2>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">Download_reference</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>Download_reference</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>Download Hapmap phase 3 and 1000 Genome phase 3 Data</h3>

<h4>Description</h4>

<p>Downloads reference data sets from specified URLs based on the reference dataset name and working directory.
Currently supports 'HapMapIII_NCBI36' and 'ThousandGenome'.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/Download_reference.html">Download_reference</a></span><span class="op">(</span><span class="va">refdata</span>, wdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="refdata">refdata</code></td>
<td>
<p>A character string specifying the reference dataset to download. Should be one of 'HapMapIII_NCBI36' or 'ThousandGenome'.</p>
</td>
</tr>
<tr>
<td><code id="wdir">wdir</code></td>
<td>
<p>A character string specifying the working directory where the reference data will be downloaded and extracted.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>Invisible. The function prints a message upon successful download and extraction of the reference data.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="co">## Not run: </span></span>
<span><span class="fu"><a href="../reference/Download_reference.html">Download_reference</a></span><span class="op">(</span><span class="st">"ThousandGenome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Download_reference.html">Download_reference</a></span><span class="op">(</span><span class="st">"HapMapIII_NCBI36"</span>, <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## End(Not run)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-31">Function 31<a class="anchor" aria-label="anchor" href="#function-31"></a>
</h2>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">SumstatGenCorr</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>SumstatGenCorr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>SumstatGenCorr: Genetic Correlation Calculation from GWAS Summary Statistics</h3>

<h4>Description</h4>

<p>This function calculates the genetic correlation between two summary statistics
using a specified reference linkage disequilibrium (LD) matrix from the UK Biobank.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/SumstatGenCorr.html">SumstatGenCorr</a></span><span class="op">(</span></span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">referenceLD</span>,</span>
<span>  <span class="va">sumstat1</span>,</span>
<span>  <span class="va">sumstat2</span>,</span>
<span>  Nref <span class="op">=</span> <span class="fl">335265</span>,</span>
<span>  N0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sumstat1</span><span class="op">$</span><span class="va">N</span><span class="op">)</span>,</span>
<span>  eigen.cut <span class="op">=</span> <span class="st">"automatic"</span>,</span>
<span>  lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  numCores <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>Directory where results should be saved.</p>
</td>
</tr>
<tr>
<td><code id="referenceLD">referenceLD</code></td>
<td>
<p>Reference LD matrix identifier. These are the LD matrices and their eigen-decomposition from 335,265 genomic
British UK Biobank individuals. Two sets of reference panel are provided:
</p>

<ol>
<li>
<p> 307,519 QCed UK Biobank Axiom Array SNPs. The size is about 7.5 GB after unzipping.
</p>
</li>
<li>
<p> 1,029,876 QCed UK Biobank imputed SNPs. The size is about 31 GB after unzipping. Although it takes more time,
using the imputed panel provides more accurate estimates of genetic correlations.
Therefore if the GWAS includes most of the HapMap3 SNPs, then it is recommend using the imputed reference panel.
</p>
</li>
</ol>
</td>
</tr>
<tr>
<td><code id="sumstat1">sumstat1</code></td>
<td>
<p>Data frame for the first set of summary statistics.
The input data frame should include following columns: SNP, SNP ID; A1, effect allele; A2, reference allele;
N, sample size; Z, z-score; If Z is not given, alternatively, you may provide: b, estimate of marginal effect in GWAS; se,
standard error of the estimates of marginal effects in GWAS.</p>
</td>
</tr>
<tr>
<td><code id="sumstat2">sumstat2</code></td>
<td>
<p>Data frame for the second set of summary statistics.
The input data frame should include following columns: SNP, SNP ID; A1, effect allele; A2, reference allele;
N, sample size; Z, z-score; If Z is not given, alternatively, you may provide: b, estimate of marginal effect in GWAS; se,
standard error of the estimates of marginal effects in GWAS.</p>
</td>
</tr>
<tr>
<td><code id="Nref">Nref</code></td>
<td>
<p>Sample size of the reference sample where LD is computed. If the default UK Biobank reference sample is used, Nref = 335265</p>
</td>
</tr>
<tr>
<td><code id="N0">N0</code></td>
<td>
<p>Number of individuals included in both cohorts. The estimated genetic correlation is usually robust against misspecified N0.
If not given, the default value is set to the minimum sample size across all SNPs in cohort 1 and cohort 2.</p>
</td>
</tr>
<tr>
<td><code id="eigen.cut">eigen.cut</code></td>
<td>
<p>Which eigenvalues and eigenvectors in each LD score matrix should be used for HDL.
Users are allowed to specify a numeric value between 0 and 1 for eigen.cut. For example, eigen.cut = 0.99 means using the
leading eigenvalues explaining 99% of the variance
and their correspondent eigenvectors. If the default 'automatic' is used, the eigen.cut gives the most stable heritability
estimates will be used.</p>
</td>
</tr>
<tr>
<td><code id="lim">lim</code></td>
<td>
<p>Tolerance limitation, default lim = exp(-18).</p>
</td>
</tr>
<tr>
<td><code id="parallel">parallel</code></td>
<td>
<p>Boolean value, TRUE or FALSE for whether to perform parallel computation. The default is FALSE</p>
</td>
</tr>
<tr>
<td><code id="numCores">numCores</code></td>
<td>
<p>The number of cores to be used. The default is 2.</p>
</td>
</tr>
</table>
<h4>Details</h4>

<p>This function requires access to the reference LD data via an environment variable.
You must set one of the following environment variables to the appropriate directory:
</p>

<ul>
<li> <p><code>UKB_ARRAY_PATH</code> for the Axiom Array reference (<code>UKB_array_SVD_eigen90_extraction</code>)
</p>
</li>
<li> <p><code>UKB_IMPUTED_PATH</code> for the full imputed reference (<code>UKB_imputed_SVD_eigen99_extraction</code>)
</p>
</li>
<li> <p><code>UKB_IMPUTED_HAPMAP2_PATH</code> for the imputed HapMap2 subset (<code>UKB_imputed_hapmap2_SVD_eigen99_extraction</code>)
</p>
</li>
</ul>
<h4>Value</h4>

<p>A list is returned with:
</p>

<ul>
<li>
<p><code>rg</code>: The estimated genetic correlation.
</p>
</li>
<li>
<p><code>rg.se</code>: The standard error of the estimated genetic correlation.
</p>
</li>
<li>
<p><code>P</code>: P-value based on Wald test.
</p>
</li>
<li>
<p><code>estimates.df</code>: A detailed matrix includes the estimates and standard errors of heritabilities, genetic covariance
and genetic correlation.
</p>
</li>
<li>
<p><code>eigen.use</code>: The eigen.cut used in computation.
</p>
</li>
</ul>
<h4>References</h4>

<p>Ning Z, Pawitan Y, Shen X (2020).
“High-definition likelihood inference of genetic correlations across human complex traits.”
<em>Nature Genetics</em>, <b>52</b>, 859–864.
<a href="https://doi.org/10.1038/s41588-020-0676-4" class="external-link">doi:10.1038/s41588-020-0676-4</a>.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">sumstat1</span> <span class="op">&lt;-</span> <span class="fu">GXwasR</span><span class="fu">:::</span><span class="fu"><a href="../reference/simulateSumstats.html">simulateSumstats</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sumstat2</span> <span class="op">&lt;-</span> <span class="fu">GXwasR</span><span class="fu">:::</span><span class="fu"><a href="../reference/simulateSumstats.html">simulateSumstats</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nzchar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"UKB_IMPUTED_HAPMAP2_PATH"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SumstatGenCorr.html">SumstatGenCorr</a></span><span class="op">(</span></span>
<span>        ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        referenceLD <span class="op">=</span> <span class="st">"UKB_imputed_hapmap2_SVD_eigen99_extraction"</span>,</span>
<span>        sumstat1 <span class="op">=</span> <span class="va">sumstat1</span>,</span>
<span>        sumstat2 <span class="op">=</span> <span class="va">sumstat2</span>,</span>
<span>        parallel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-32">Function 32<a class="anchor" aria-label="anchor" href="#function-32"></a>
</h2>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">LDPrune</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>LDPrune</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>LDPrune: Performs LD pruning on SNP data using PLINK</h3>

<h4>Description</h4>

<p>This function utilizes PLINK to perform LD pruning on genetic data. It identifies and removes SNPs that are in high
linkage disequilibrium with each other within specified windows.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/LDPrune.html">LDPrune</a></span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  step_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  r2_threshold <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>Character string representing the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string specifying the prefix of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>Character string for the file path where all output files will be stored, defaulting to a temporary directory.</p>
</td>
</tr>
<tr>
<td><code id="window_size">window_size</code></td>
<td>
<p>Integer, specifying the number of SNPs to include in the sliding window.</p>
</td>
</tr>
<tr>
<td><code id="step_size">step_size</code></td>
<td>
<p>Integer, specifying the number of SNPs the window moves over in each step.</p>
</td>
</tr>
<tr>
<td><code id="r2_threshold">r2_threshold</code></td>
<td>
<p>Numeric, specifying the R^2 threshold for LD pruning.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>Returns a character vector of SNP identifiers that remain after LD pruning or NULL if an error occurs.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">prunedSNPs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LDPrune.html">LDPrune</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">finput</span>, <span class="va">ResultDir</span>, <span class="fl">50</span>, <span class="fl">5</span>, <span class="fl">0.2</span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-33">Function 33<a class="anchor" aria-label="anchor" href="#function-33"></a>
</h2>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">executePlinkMAF</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>executePlinkMAF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>executePlinkMAF: Execute PLINK to Calculate Minor Allele Frequencies (MAF)</h3>

<h4>Description</h4>

<p>This function executes PLINK to calculate minor allele frequencies (MAF) for a given dataset. It sets up the necessary PLINK environment,
runs the PLINK command, and returns the MAF results as a DataFrame. Intermediate files generated by PLINK are cleaned up after execution.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/executePlinkMAF.html">executePlinkMAF</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>Character. Directory containing the input PLINK files (.bed, .bim, .fam).</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>Character. Directory to store the output files generated by PLINK.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character. Base name of the PLINK input files (without extensions).</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>DataFrame containing the minor allele frequency (MAF) results.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span>
<span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span>
<span><span class="va">maf_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/executePlinkMAF.html">executePlinkMAF</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="function-34">Function 34<a class="anchor" aria-label="anchor" href="#function-34"></a>
</h2>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">ComputeLD</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></code></pre></div>
<div class="r-help-page">
<div class="container"><main><table style="width: 100%;" class="table"><tr>
<td>ComputeLD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h3>ComputeLD: Compute Linkage Disequilibrium (LD) for SNP Data</h3>

<h4>Description</h4>

<p>This function computes linkage disequilibrium (LD) statistics for SNP data using PLINK. It allows for computation across all
SNPs or within specific chromosomes.
</p>


<h4>Usage</h4>

<pre><code class="language-R"><span><span class="fu"><a href="../reference/ComputeLD.html">ComputeLD</a></span><span class="op">(</span><span class="va">DataDir</span>, <span class="va">ResultDir</span>, <span class="va">finput</span>, ByCHR <span class="op">=</span> <span class="cn">FALSE</span>, CHRnum <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">r2_LD</span><span class="op">)</span></span></code></pre>


<h4>Arguments</h4>

<table role="presentation" class="table">
<tr>
<td><code id="DataDir">DataDir</code></td>
<td>
<p>Character string representing the file path of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ResultDir">ResultDir</code></td>
<td>
<p>Character string for the file path where all output files will be stored, defaulting to a temporary directory.</p>
</td>
</tr>
<tr>
<td><code id="finput">finput</code></td>
<td>
<p>Character string specifying the prefix of the input PLINK binary files.</p>
</td>
</tr>
<tr>
<td><code id="ByCHR">ByCHR</code></td>
<td>
<p>Logical indicating whether to perform the computation by chromosome. The default is FALSE.</p>
</td>
</tr>
<tr>
<td><code id="CHRnum">CHRnum</code></td>
<td>
<p>If ByCHR is TRUE, specifies the chromosome number for which LD should be computed. The default is NULL.</p>
</td>
</tr>
<tr>
<td><code id="r2_LD">r2_LD</code></td>
<td>
<p>The threshold for r-squared LD values to report in the output.</p>
</td>
</tr>
</table>
<h4>Value</h4>

<p>Returns a data frame containing the computed LD values among SNPs, read from the output file generated by PLINK.
</p>


<h4>Examples</h4>

<pre><code class="language-R"><span><span class="va">snpld</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ComputeLD.html">ComputeLD</a></span><span class="op">(</span></span>
<span>    DataDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span>, ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    finput <span class="op">=</span> <span class="st">"GXwasR_example"</span>, ByCHR <span class="op">=</span> <span class="cn">TRUE</span>, CHRnum <span class="op">=</span> <span class="fl">1</span>, r2_LD <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span></code></pre>

</main></div>
</div>
</div>
<div class="section level2">
<h2 id="tutorials">Tutorials<a class="anchor" aria-label="anchor" href="#tutorials"></a>
</h2>
<p>Please follow these tutorials to know more about the functionality of
the package GXwasR.</p>
<p>Tutorial for performing post-imputation QC followed by sex-aware
association tests: (vignette:Use of GXwasR)</p>
<p>Tutorial for performing pre-imputation QC using GXwasR:</p>
<p>Tutorial for performing post-imputation QC using GXwasR:</p>
<p>Tutorial for sex-combined and sex-stratified GWAS with
XWAS:<strong>hdhghchjfvjh</strong></p>
<p>Tutorial for sex-differential test:<strong>gdhgdcmh</strong></p>
<p>Tutorial for ancestry estimation:</p>
<p>Tutorial for computing polygenic risk
score:<strong>jcjjcjh</strong></p>
<p>Tutorial for meta analysis:</p>
<p>Tutorial for heritability estimate and genetic correlation:</p>
<p>Tutorial for gene-based tests:</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Banabithi Bose.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
