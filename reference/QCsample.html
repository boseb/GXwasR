<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>QCsample: Quality control for samples in the PLINK binary files. — QCsample • GXwasR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="QCsample: Quality control for samples in the PLINK binary files. — QCsample"><meta name="description" content="This function identifies outlier individuals for heterozygosity and/or missing genotype rates, which aids in the
detection of samples with subpar DNA quality and/or concentration that should be removed from the study. Individuals
missing more than 3-7% of their genotype calls are often excluded from the analysis.
Having the correct designation of sex is important to obtain accurate genotype rate estimates, or avoid incorrectly
removing samples, etc. Details can be accessed from the paper."><meta property="og:description" content="This function identifies outlier individuals for heterozygosity and/or missing genotype rates, which aids in the
detection of samples with subpar DNA quality and/or concentration that should be removed from the study. Individuals
missing more than 3-7% of their genotype calls are often excluded from the analysis.
Having the correct designation of sex is important to obtain accurate genotype rate estimates, or avoid incorrectly
removing samples, etc. Details can be accessed from the paper."><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GXwasR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/GXwasR_overview.html">GXwasR Overview</a></li>
    <li><a class="dropdown-item" href="../articles/preimputationQC.html">Pre-impute Quality Control Pipeline Using GXwasR</a></li>
    <li><a class="dropdown-item" href="../articles/postimputationQC.html">Sex-aware Post-impute Quality Control Pipeline Using GXwasR</a></li>
    <li><a class="dropdown-item" href="../articles/gwas_models.html">Running GWAS, XWAS and Sex-differential tests Using GXwasR</a></li>
    <li><a class="dropdown-item" href="../articles/GXwasR_PRS.html">Computing Polygenic Risk Score using GXwasR</a></li>
    <li><a class="dropdown-item" href="../articles/decoding_ancestry.html">Decoding Ancestry: A Guide to Using GXwasR for Genetic Ancestry Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/meta_analysis.html">GWAS Meta analysis Using GXwasR</a></li>
    <li><a class="dropdown-item" href="../articles/genetic_correlation_sumstat.html">Genetic Correlation using GWAS Summary Statistics</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/boseb/GXwasR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>QCsample: Quality control for samples in the PLINK binary files.</h1>
      <small class="dont-index">Source: <a href="https://github.com/boseb/GXwasR/blob/HEAD/R/GXwasR_main_functions.R" class="external-link"><code>R/GXwasR_main_functions.R</code></a></small>
      <div class="d-none name"><code>QCsample.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function identifies outlier individuals for heterozygosity and/or missing genotype rates, which aids in the
detection of samples with subpar DNA quality and/or concentration that should be removed from the study. Individuals
missing more than 3-7% of their genotype calls are often excluded from the analysis.</p>
<p>Having the correct designation of sex is important to obtain accurate genotype rate estimates, or avoid incorrectly
removing samples, etc. Details can be accessed from the paper.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">QCsample</span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  <span class="va">ResultDir</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  foutput <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">imiss</span>,</span>
<span>  <span class="va">het</span>,</span>
<span>  small_sample_mod <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">IBD</span>,</span>
<span>  IBDmatrix <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ambi_out <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend_text_size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  legend_title_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  axis_text_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  axis_title_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  title_size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  filterSample <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-datadir">DataDir<a class="anchor" aria-label="anchor" href="#arg-datadir"></a></dt>
<dd><p>Character string, specifying the file path of the input PLINK binary files. The default is <code>NULL</code>.</p></dd>


<dt id="arg-resultdir">ResultDir<a class="anchor" aria-label="anchor" href="#arg-resultdir"></a></dt>
<dd><p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p></dd>


<dt id="arg-finput">finput<a class="anchor" aria-label="anchor" href="#arg-finput"></a></dt>
<dd><p>Character string, specifying the prefix of the input PLINK binary files with both male and female samples.
This file needs to be in <code>DataDir</code>.</p></dd>


<dt id="arg-foutput">foutput<a class="anchor" aria-label="anchor" href="#arg-foutput"></a></dt>
<dd><p>Character string, specifying the prefix of the output PLINK binary files if filtering option for the samples is chosen.</p></dd>


<dt id="arg-imiss">imiss<a class="anchor" aria-label="anchor" href="#arg-imiss"></a></dt>
<dd><p>Numeric value between 0 to 1 for removing samples that have more than the specified missingness. The default is 0.03.</p></dd>


<dt id="arg-het">het<a class="anchor" aria-label="anchor" href="#arg-het"></a></dt>
<dd><p>Positive numeric value, specifying the standard deviation from the mean heterozygosity rate. The samples whose rates are more
than the specified sd from the mean heterozygosity rate are removed. The default is 3. With this default value, outlying
heterozygosity rates would remove individuals who are three sd away from the mean rate (1).</p></dd>


<dt id="arg-small-sample-mod">small_sample_mod<a class="anchor" aria-label="anchor" href="#arg-small-sample-mod"></a></dt>
<dd><p>Boolean value indicating whether to apply modifications for small sample sizes. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-ibd">IBD<a class="anchor" aria-label="anchor" href="#arg-ibd"></a></dt>
<dd><p>Numeric value for setting the threshold for Identity by Descent (IBD) analysis. Default is <code>NULL</code>.</p></dd>


<dt id="arg-ibdmatrix">IBDmatrix<a class="anchor" aria-label="anchor" href="#arg-ibdmatrix"></a></dt>
<dd><p>Boolean value indicating whether to generate an entire IBD matrix. Default is <code>FALSE</code>. In this case filtered IBD
matrix will be stored.</p></dd>


<dt id="arg-ambi-out">ambi_out<a class="anchor" aria-label="anchor" href="#arg-ambi-out"></a></dt>
<dd><p>Boolean value indicating whether to process ambiguous samples.</p></dd>


<dt id="arg-legend-text-size">legend_text_size<a class="anchor" aria-label="anchor" href="#arg-legend-text-size"></a></dt>
<dd><p>Integer, specifying the size for legend text in the plot.</p></dd>


<dt id="arg-legend-title-size">legend_title_size<a class="anchor" aria-label="anchor" href="#arg-legend-title-size"></a></dt>
<dd><p>Integer, specifying the size for the legend title in the plot.</p></dd>


<dt id="arg-axis-text-size">axis_text_size<a class="anchor" aria-label="anchor" href="#arg-axis-text-size"></a></dt>
<dd><p>Integer, specifying the size for axis text in the plot.</p></dd>


<dt id="arg-axis-title-size">axis_title_size<a class="anchor" aria-label="anchor" href="#arg-axis-title-size"></a></dt>
<dd><p>Integer, specifying the size for the axis title in the plot.</p></dd>


<dt id="arg-title-size">title_size<a class="anchor" aria-label="anchor" href="#arg-title-size"></a></dt>
<dd><p>Integer, specifying the size of the title of the plot heterozygosity estimate vs missingness across samples.</p></dd>


<dt id="arg-filtersample">filterSample<a class="anchor" aria-label="anchor" href="#arg-filtersample"></a></dt>
<dd><p>Boolean value, <code>TRUE</code> or <code>FALSE</code> for filtering out the samples or not (i.e., only flagged). The default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A plot of heterogysity estimate vs missingness across sample and a list containing five R dataframe objects, namely,
<code>HM</code> (samples with outlying heterozygosity and/or missing genotype rates), <code>Failed_Missingness</code> (samples with missing genotype rates),
<code>Failed_heterozygosity</code> (samples with outlying heterozygosity), <code>Missingness_results</code> (missingness results) and <code>Heterozygosity_results</code>
(heterozygosity results) with output PLINK files in ResultDir if filtering out the samples option is chosen.</p>
<p><code>Missingness_results</code> contains missingness results for each individual, with six columns as <code>FID</code>, <code>IID</code>, <code>MISS_PHENO</code>, <code>N_MISS</code>, <code>N_GENO</code> and
<code>F_MISS</code> for Family ID, Within-family ID, Phenotype missing? (Y/N), Number of missing genotype call(s), not including obligatory missings
or heterozygous haploids, number of potentially valid call(s), and missing call rate, respectively.</p>
<p><code>Heterozygosity_results</code> contains heterozygosity results for each individual, with six columns as <code>FID</code>, <code>IID</code>, <code>O(HOM)</code>, <code>E(HOM)</code>, <code>N(NM)</code>,
and <code>F</code> for Family ID, Within-family ID, Observed number of homozygotes, Expected number of homozygotes, Number of (non-missing, non-monomorphic)
autosomal genotype observations and, Method-of-moments F coefficient estimate, respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Banabithi Bose</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu">GXwasR</span><span class="fu">:::</span><span class="fu"><a href="GXwasR_data.html">GXwasR_data</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span></span>
<span class="r-in"><span><span class="va">foutput</span> <span class="op">&lt;-</span> <span class="st">"Test_output"</span></span></span>
<span class="r-in"><span><span class="va">imiss</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span></span>
<span class="r-in"><span><span class="va">het</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">small_sample_mod</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span></span>
<span class="r-in"><span><span class="va">IBDmatrix</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="va">ambi_out</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">QCsample</span><span class="op">(</span></span></span>
<span class="r-in"><span>    DataDir <span class="op">=</span> <span class="va">DataDir</span>, ResultDir <span class="op">=</span> <span class="va">ResultDir</span>, finput <span class="op">=</span> <span class="va">finput</span>,</span></span>
<span class="r-in"><span>    foutput <span class="op">=</span> <span class="va">foutput</span>, imiss <span class="op">=</span> <span class="va">imiss</span>, het <span class="op">=</span> <span class="va">het</span>, IBD <span class="op">=</span> <span class="va">IBD</span>,</span></span>
<span class="r-in"><span>    ambi_out <span class="op">=</span> <span class="va">ambi_out</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Plots are initiated.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No. of samples filtered/flagged for missingness: 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No. of samples filtered/flagged for heterozygosity threshold: 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No. of samples filtered/flagged for missingness and heterozygosity: 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No. of samples marked to be filtered out for IDB after missingness and heterozygosity filter: 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No. of samples in input PLINK files: 276</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No. of samples in output PLINK files: 271</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Output PLINK files, Test_output with final samples are in /var/folders/d6/gtwl3_017sj4pp14fbfcbqjh0000gp/T//RtmpO7c0S8.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Banabithi Bose.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

