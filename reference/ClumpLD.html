<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ClumpLD: Clumping SNPs using linkage disequilibrium between SNPs — ClumpLD • GXwasR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ClumpLD: Clumping SNPs using linkage disequilibrium between SNPs — ClumpLD"><meta name="description" content="This function, which is based on empirical estimations of linkage disequilibrium between SNPs, groups the SNP-based results
across one or more datasets or analysis. This approach can be used in two basic scenarios: (i) To summarize the top X single
SNP findings from a genome-wide scan as fewer clusters of connected SNPs (i.e., to assess how many independent loci are
associated). (ii) To give researchers a simple approach to merge sets of data from multiple studies when those studies may
have used various marker sets for genotyping.
The clumping process begins with the index SNPs that are significant at threshold p1 and have not yet been clumped. It then
creates clumps of all additional SNPs that are within a specified kb of the index SNP and that are in linkage disequilibrium
with the index SNP based on an r-squared threshold. Following that, these SNPs are filtered based on the outcome for that SNP.
As this method is greedy (Purcell et al. 2007)
, each SNP will, at most, only appear in one clump. The P value and
ALLELES would always, at random, be chosen from the first input file if the same SNP appeared in several input files in SNPdata
argument. Instead of the best p-value, the function refer to the SNP that has the strongest LD to the index as the best proxy.
Based on the genotype data, the SNP with the highest LD will be the same for all input files."><meta property="og:description" content="This function, which is based on empirical estimations of linkage disequilibrium between SNPs, groups the SNP-based results
across one or more datasets or analysis. This approach can be used in two basic scenarios: (i) To summarize the top X single
SNP findings from a genome-wide scan as fewer clusters of connected SNPs (i.e., to assess how many independent loci are
associated). (ii) To give researchers a simple approach to merge sets of data from multiple studies when those studies may
have used various marker sets for genotyping.
The clumping process begins with the index SNPs that are significant at threshold p1 and have not yet been clumped. It then
creates clumps of all additional SNPs that are within a specified kb of the index SNP and that are in linkage disequilibrium
with the index SNP based on an r-squared threshold. Following that, these SNPs are filtered based on the outcome for that SNP.
As this method is greedy (Purcell et al. 2007)
, each SNP will, at most, only appear in one clump. The P value and
ALLELES would always, at random, be chosen from the first input file if the same SNP appeared in several input files in SNPdata
argument. Instead of the best p-value, the function refer to the SNP that has the strongest LD to the index as the best proxy.
Based on the genotype data, the SNP with the highest LD will be the same for all input files."><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GXwasR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/GXwasR_overview.html">GXwasR Overview</a></li>
    <li><a class="dropdown-item" href="../articles/preimputationQC.html">Pre-impute Quality Control Pipeline Using GXwasR</a></li>
    <li><a class="dropdown-item" href="../articles/postimputationQC.html">Sex-aware Post-impute Quality Control Pipeline Using GXwasR</a></li>
    <li><a class="dropdown-item" href="../articles/gwas_models.html">Running GWAS, XWAS and Sex-differential tests Using GXwasR</a></li>
    <li><a class="dropdown-item" href="../articles/GXwasR_PRS.html">Computing Polygenic Risk Score using GXwasR</a></li>
    <li><a class="dropdown-item" href="../articles/decoding_ancestry.html">Decoding Ancestry: A Guide to Using GXwasR for Genetic Ancestry Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/meta_analysis.html">GWAS Meta analysis Using GXwasR</a></li>
    <li><a class="dropdown-item" href="../articles/genetic_correlation_sumstat.html">Genetic Correlation using GWAS Summary Statistics</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/boseb/GXwasR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>ClumpLD: Clumping SNPs using linkage disequilibrium between SNPs</h1>
      <small class="dont-index">Source: <a href="https://github.com/boseb/GXwasR/blob/HEAD/R/GXwasR_main_functions.R" class="external-link"><code>R/GXwasR_main_functions.R</code></a></small>
      <div class="d-none name"><code>ClumpLD.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function, which is based on empirical estimations of linkage disequilibrium between SNPs, groups the SNP-based results
across one or more datasets or analysis. This approach can be used in two basic scenarios: (i) To summarize the top X single
SNP findings from a genome-wide scan as fewer clusters of connected SNPs (i.e., to assess how many independent loci are
associated). (ii) To give researchers a simple approach to merge sets of data from multiple studies when those studies may
have used various marker sets for genotyping.</p>
<p>The clumping process begins with the index SNPs that are significant at threshold p1 and have not yet been clumped. It then
creates clumps of all additional SNPs that are within a specified kb of the index SNP and that are in linkage disequilibrium
with the index SNP based on an r-squared threshold. Following that, these SNPs are filtered based on the outcome for that SNP.
As this method is greedy (Purcell et al. 2007)
, each SNP will, at most, only appear in one clump. The P value and
ALLELES would always, at random, be chosen from the first input file if the same SNP appeared in several input files in SNPdata
argument. Instead of the best p-value, the function refer to the SNP that has the strongest LD to the index as the best proxy.
Based on the genotype data, the SNP with the highest LD will be the same for all input files.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ClumpLD</span><span class="op">(</span></span>
<span>  <span class="va">DataDir</span>,</span>
<span>  <span class="va">finput</span>,</span>
<span>  <span class="va">SNPdata</span>,</span>
<span>  ResultDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">clump_p1</span>,</span>
<span>  <span class="va">clump_p2</span>,</span>
<span>  <span class="va">clump_r2</span>,</span>
<span>  <span class="va">clump_kb</span>,</span>
<span>  byCHR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clump_best <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clump_index_first <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-datadir">DataDir<a class="anchor" aria-label="anchor" href="#arg-datadir"></a></dt>
<dd><p>A character string for the file path of the input PLINK binary files.</p></dd>


<dt id="arg-finput">finput<a class="anchor" aria-label="anchor" href="#arg-finput"></a></dt>
<dd><p>Character string, specifying the prefix of the input PLINK binary files which will be used to calculate linkage disequilibrium
between the SNPs. This actual genotype data may or may not be the same dataset that was used to generate the summary statistics.
This file needs to be in <code>DataDir</code>.</p></dd>


<dt id="arg-snpdata">SNPdata<a class="anchor" aria-label="anchor" href="#arg-snpdata"></a></dt>
<dd><p>A list of R dataframes containing a single or multiple summary statistics with SNP and P (i.e., p-values) in mandatory column
headers. Other columns could be present.</p></dd>


<dt id="arg-resultdir">ResultDir<a class="anchor" aria-label="anchor" href="#arg-resultdir"></a></dt>
<dd><p>A character string for the file path where all output files will be stored. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.</p></dd>


<dt id="arg-clump-p-">clump_p1<a class="anchor" aria-label="anchor" href="#arg-clump-p-"></a></dt>
<dd><p>Numeric value, specifying the significance threshold for index SNPs. The default is 0.0001.</p></dd>


<dt id="arg-clump-p-">clump_p2<a class="anchor" aria-label="anchor" href="#arg-clump-p-"></a></dt>
<dd><p>Numeric value, specifying the secondary significance threshold for clumped SNPs. The default is 0.01</p></dd>


<dt id="arg-clump-r-">clump_r2<a class="anchor" aria-label="anchor" href="#arg-clump-r-"></a></dt>
<dd><p>Numeric value, specifying the LD threshold for clumping. The default is 0.50.</p></dd>


<dt id="arg-clump-kb">clump_kb<a class="anchor" aria-label="anchor" href="#arg-clump-kb"></a></dt>
<dd><p>Integer value, specifying the physical distance threshold in base-pair for clumping. The default is 250.</p></dd>


<dt id="arg-bychr">byCHR<a class="anchor" aria-label="anchor" href="#arg-bychr"></a></dt>
<dd><p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to perform the clumping chromosome-wise.</p></dd>


<dt id="arg-clump-best">clump_best<a class="anchor" aria-label="anchor" href="#arg-clump-best"></a></dt>
<dd><p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to select and output the best SNP from each clump. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-clump-index-first">clump_index_first<a class="anchor" aria-label="anchor" href="#arg-clump-index-first"></a></dt>
<dd><p>Boolean value, <code>TRUE</code> or <code>FALSE</code>, specifying whether to force the index SNP to appear first in each clump. This option should
typically be <code>TRUE</code> if clump_best is <code>TRUE.</code> Default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with two dataframes.</p>
<p>BestClump: a dataframe with eight columns showing the single best proxy SNP for each index SNP with
columns "INDEX"(Index SNP identifier), "PSNP"(Best proxy SNP), "RSQ LD"(r-squared) between index and proxy,
"KB"(Physical distance between index and proxy), P(p-value for proxy SNP), "ALLELES"(The associated haplotypes for the index and proxy SNP),
and "F"(Which file used for clumping from which this result came from).</p>
<p>AllClump: a dataframe with eight columns providing a detailed summary
of each clump identified by PLINK. It includes "INDEX_SNP" (the identifier for the index SNP that represents the clump), "SNP"
(the SNP being reported, which for the index SNP is the same as INDEX_SNP), "DISTANCE" (the physical distance in base pairs between the index
SNP and the reported SNP, with 0.0 indicating the index itself), "RSQ" (the r-squared value showing the degree of linkage disequilibrium between
the index SNP and the SNP in the clump), "ALLELES" (the allele information, which in some cases may appear misaligned if the data isn’t formatted
as expected), "F" (a statistic or indicator related to the association test, which may be NA when not applicable), "P" (the p-value for the
association test of the SNP), and "CHR" (the chromosome on which the SNP is located).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Purcell S, Neale B, Todd-Brown K, Thomas L, Ferreira MAR, Bender D, Maller J, Sklar P, de Bakker PIW, Daly MJ, others (2007).
“PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses.”
<em>The American Journal of Human Genetics</em>, <b>81</b>(3), 559–575.
<a href="https://doi.org/10.1086/519795" class="external-link">doi:10.1086/519795</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Banabithi Bose</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Summary_Stat_Ex1"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Summary_Stat_Ex2"</span>, package <span class="op">=</span> <span class="st">"GXwasR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DataDir</span> <span class="op">&lt;-</span> <span class="fu">GXwasR</span><span class="fu">:::</span><span class="fu"><a href="GXwasR_data.html">GXwasR_data</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ResultDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">finput</span> <span class="op">&lt;-</span> <span class="st">"GXwasR_example"</span></span></span>
<span class="r-in"><span><span class="va">SNPdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Summary_Stat_Ex1</span>, <span class="va">Summary_Stat_Ex2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clump_p1</span> <span class="op">&lt;-</span> <span class="fl">0.0001</span></span></span>
<span class="r-in"><span><span class="va">clump_p2</span> <span class="op">&lt;-</span> <span class="fl">0.001</span></span></span>
<span class="r-in"><span><span class="va">clump_r2</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">clump_kb</span> <span class="op">&lt;-</span> <span class="fl">250</span></span></span>
<span class="r-in"><span><span class="va">byCHR</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="va">clumpedResult</span> <span class="op">&lt;-</span> <span class="fu">ClumpLD</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">DataDir</span>, <span class="va">finput</span>, <span class="va">SNPdata</span>, <span class="va">ResultDir</span>, <span class="va">clump_p1</span>,</span></span>
<span class="r-in"><span>    <span class="va">clump_p2</span>, <span class="va">clump_r2</span>, <span class="va">clump_kb</span>, <span class="va">byCHR</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Processing summary statistics 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Processing summary statistics 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 6</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 6</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 7</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 7</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 8</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 8</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 9</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 9</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 23</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Running LD clumping for chromosome 24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> No significant clump results for chromosome 24</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Banabithi Bose.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

