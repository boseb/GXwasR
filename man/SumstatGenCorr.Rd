% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GXwasR_main_functions.R
\name{SumstatGenCorr}
\alias{SumstatGenCorr}
\title{SumstatGenCorr: Genetic Correlation Calculation from GWAS Summary Statistics}
\usage{
SumstatGenCorr(
  ResultDir = tempdir(),
  referenceLD,
  sumstat1,
  sumstat2,
  Nref = 335265,
  N0 = min(sumstat1$N),
  eigen.cut = "automatic",
  lim = exp(-18),
  parallel = FALSE,
  numCores = 2
)
}
\arguments{
\item{ResultDir}{Directory where results should be saved.}

\item{referenceLD}{Reference LD matrix identifier. These are the LD matrices and their eigen-decomposition from 335,265 genomic
British UK Biobank individuals. Two sets of reference panel are provided:
\enumerate{
\item 307,519 QCed UK Biobank Axiom Array SNPs. The size is about 7.5 GB after unzipping.
\item 1,029,876 QCed UK Biobank imputed SNPs. The size is about 31 GB after unzipping. Although it takes more time,
using the imputed panel provides more accurate estimates of genetic correlations.
Therefore if the GWAS includes most of the HapMap3 SNPs, then it is recommend using the imputed reference panel.
}}

\item{sumstat1}{Data frame for the first set of summary statistics.
The input data frame should include following columns: SNP, SNP ID; A1, effect allele; A2, reference allele;
N, sample size; Z, z-score; If Z is not given, alternatively, you may provide: b, estimate of marginal effect in GWAS; se,
standard error of the estimates of marginal effects in GWAS.}

\item{sumstat2}{Data frame for the second set of summary statistics.
The input data frame should include following columns: SNP, SNP ID; A1, effect allele; A2, reference allele;
N, sample size; Z, z-score; If Z is not given, alternatively, you may provide: b, estimate of marginal effect in GWAS; se,
standard error of the estimates of marginal effects in GWAS.}

\item{Nref}{Sample size of the reference sample where LD is computed. If the default UK Biobank reference sample is used, Nref = 335265}

\item{N0}{Number of individuals included in both cohorts. The estimated genetic correlation is usually robust against misspecified N0.
If not given, the default value is set to the minimum sample size across all SNPs in cohort 1 and cohort 2.}

\item{eigen.cut}{Which eigenvalues and eigenvectors in each LD score matrix should be used for HDL.
Users are allowed to specify a numeric value between 0 and 1 for eigen.cut. For example, eigen.cut = 0.99 means using the
leading eigenvalues explaining 99\% of the variance
and their correspondent eigenvectors. If the default 'automatic' is used, the eigen.cut gives the most stable heritability
estimates will be used.}

\item{lim}{Tolerance limitation, default lim = exp(-18).}

\item{parallel}{Boolean value, TRUE or FALSE for whether to perform parallel computation. The default is FALSE}

\item{numCores}{The number of cores to be used. The default is 2.}
}
\value{
A list is returned with:
\itemize{
\item{\code{rg}}: The estimated genetic correlation.
\item{\code{rg.se}}: The standard error of the estimated genetic correlation.
\item{\code{P}}: P-value based on Wald test.
\item{\code{estimates.df}}: A detailed matrix includes the estimates and standard errors of heritabilities, genetic covariance
and genetic correlation.
\item{\code{eigen.use}}: The eigen.cut used in computation.
}
}
\description{
This function calculates the genetic correlation between two summary statistics
using a specified reference linkage disequilibrium (LD) matrix from the UK Biobank.
}
\details{
This function requires access to the reference LD data via an environment variable.
You must set one of the following environment variables to the appropriate directory:
\itemize{
\item \code{UKB_ARRAY_PATH} for the Axiom Array reference (\code{UKB_array})
\item \code{UKB_IMPUTED_PATH} for the full imputed reference (\code{UKB_imputed})
\item \code{UKB_IMPUTED_HAPMAP2_PATH} for the imputed HapMap2 subset (\code{UKB_imputed_hapmap2})
}
}
\examples{
sumstat1 <- data.frame(SNP = "rs1", A1 = "A", A2 = "G", N = 1000, Z = 2.5)
sumstat2 <- data.frame(SNP = "rs1", A1 = "A", A2 = "G", N = 1000, Z = 1.8)
if (nzchar(Sys.getenv("UKB_IMPUTED_HAPMAP2_PATH"))) {
ResultDir = tempdir()
 res <- SumstatGenCorr(ResultDir, "UKB_imputed_hapmap2_SVD_eigen99_extraction",
                      "sumstat1", "sumstat2")
}
}
\references{
\insertRef{Ning2020}{GXwasR}
}
