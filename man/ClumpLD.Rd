% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GXwasR_main_functions.R
\name{ClumpLD}
\alias{ClumpLD}
\title{ClumpLD: Clumping SNPs using linkage disequilibrium between SNPs}
\usage{
ClumpLD(
  DataDir,
  finput,
  SNPdata,
  ResultDir = tempdir(),
  clump_p1,
  clump_p2,
  clump_r2,
  clump_kb,
  byCHR = TRUE
)
}
\arguments{
\item{DataDir}{A character string for the file path of the input PLINK binary files.}

\item{finput}{Character string, specifying the prefix of the input PLINK binary files which will be used to calculate linkage disequilibrium between the SNPs. This actual genotype data may or may not be the same dataset that was used to generate the summary statistics. This file needs to be in DataDir.}

\item{SNPdata}{a list of R dataframes containing a single or multiple summary statistics with SNP and P (i.e., p-values) in mandatory column headers. Other columns could be present.}

\item{ResultDir}{A character string for the file path where all output files will be stored. The default is tempdir().}

\item{clump_p1}{Numeric value, specifying the significance threshold for index SNPs. The default is 0.0001.}

\item{clump_p2}{Numeric value, specifying the secondary significance threshold for clumped SNPs. The default is 0.01}

\item{clump_r2}{Numeric value, specifying the LD threshold for clumping. The default is 0.50.}

\item{clump_kb}{Integer value, specifying the physical distance threshold in base-pair for clumping. The default is 250.}

\item{byCHR}{Boolean value, 'TRUE' or 'FALSE', specifying whether to perform the clumping chromosome-wise.}
}
\value{
A dataframe with twelve columns:'CHR'(Chromosome code), 'F'(SNPdata fileset code as 1,2,...), 'SNP'(SNP identifier), 'BP'(Physical position of SNP inbase-pairs),'TOTAL'(Total number of other SNPs in clump i.e. passing clump_kb and clump_r2 thresholds), 'NSIG'(Number of clumped SNPs that are not significant p > 0.05), 'S05'(Number of clumped SNPs 0.01 < p < 0.05), 'S01'(Number of clumped SNPs 0.001 < p < 0.01), 'S001'(Number of clumped SNPs 0.0001 < p < 0.001), 'S0001'(Number of clumped SNPs p < 0.0001), 'SP2'(List of SNPs names and SNPdata code) clumped and significant at clump_p2 threshold.
}
\description{
This function, which is based on empirical estimations of linkage disequilibrium between SNPs, groups the SNP-based results across one or more datasets or analysis. This approach can be used in two basic scenarios: (i) To summarize the top X single SNP findings from a genome-wide scan as fewer clusters of connected SNPs (i.e., to assess how many independent loci are associated). (ii) To give researchers a simple approach to merge sets of data from multiple studies when those studies may have used various marker sets for genotyping.
The clumping process begins with the index SNPs that are significant at threshold p1 and have not yet been clumped. It then creates clumps of all additional SNPs that are within a specified kb of the index SNP and that are in linkage disequilibrium with the index SNP based on an r-squared threshold. Following that, these SNPs are filtered based on the outcome for that SNP. As this method is greedy (1), each SNP will, at most, only appear in one clump. The P value and ALLELES would always, at random, be chosen from the first input file if the same SNP appeared in several input files in SNPdata argument. Instead of the best p-value, the function refer to the SNP that has the strongest LD to the index as the best proxy. Based on the genotype data, the SNP with the highest LD will be the same for all input files.
}
\examples{
DataDir <- system.file("extdata", package = "GXwasR")
ResultDir = tempdir()
finput <- "GXwasR_example"
data("GXwasRData")
#load(paste0("/projects/b1137/BBose/GXwasR/data/Summary_Stat_Ex1.Rda"))
#load(paste0("/projects/b1137/BBose/GXwasR/data/Summary_Stat_Ex2.Rda"))
SNPdata <- list(Summary_Stat_Ex1,Summary_Stat_Ex2)
clump_p1 = 0.0001
clump_p2 = 0.001
clump_r2 = 0.5
clump_kb = 250
byCHR = TRUE
clumpedResult <- ClumpLD(DataDir,finput,SNPdata,ResultDir,clump_p1,clump_p2,clump_r2,clump_kb, byCHR)
}
\references{
(1) Purcell et. al.,(2007). PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses. The American Journal of Human Genetics, 81(3), 559-575. https://doi.org/10.1086/519795.
}
\author{
Banabithi Bose
}
