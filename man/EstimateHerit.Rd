% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GXwasR_main_functions.R
\name{EstimateHerit}
\alias{EstimateHerit}
\title{EstimateHerit: Computing SNP heritability i.e., the proportion of phenotypic variance explained by SNPs.}
\usage{
EstimateHerit(
  DataDir,
  ResultDir,
  finput,
  summarystat = NULL,
  ncores,
  model = c("LDSC", "GREML"),
  byCHR = FALSE,
  r2_LD = 0,
  LDSC_blocks = 20,
  REMLalgo = c(0, 1, 2),
  nitr = 100,
  cat_covarfile = NULL,
  quant_covarfile = NULL,
  prevalance = 0.01,
  partGRM = FALSE,
  autosome = TRUE,
  Xsome = TRUE,
  nGRM = 3,
  cripticut = 0.025,
  minMAF = NULL,
  maxMAF = NULL,
  hg = c("hg19", "hg38"),
  PlotIndepSNP = c(TRUE, FALSE),
  IndepSNP_window_size = 50,
  IndepSNP_step_size = 5,
  IndepSNP_r2_threshold = 0.02,
  highLD_regions = NULL
)
}
\arguments{
\item{DataDir}{A character string for the file path of the all the input files.}

\item{ResultDir}{A character string for the file path where all output files will be stored. The default is tempdir().}

\item{finput}{Character string, specifying the prefix of the input PLINK binary files for the genotype data. This file needs to be in DataDir. For LDSC model, if the original genotype data is not available, Hapmap 3 or 1000Genome data can be used.}

\item{summarystat}{A dataframe object with GWAS summary statistics. The mandatory column headers in this dataframe are 'chr'(Chromosome code), 'pos'(Basepair position), 'a1' (First allele code), ‘rsid’ (i.e., SNP idenitifier), ‘beta’ (i.e., effect-size or logarithm of odds ratio), ‘beta_se’ (i.e., standard error of beta), ‘P’ (i.e., p-values) and 'n_eff' (i.e., effective sample size).  For case-control study, effective sample size should be 4 / (1/<# of cases> + 1/<# of controls>). The default is NULL.}

\item{ncores}{Integer value, specifying the number of cores to be used for running LDSC model. The default is nb_cores().}

\item{model}{Character string, specifying the heritability estimation model. There are two options, “GREML” or “LDSC”. The default is “GREML”.}

\item{byCHR}{Boolean value, 'TRUE' or 'FALSE', specifying whether the analysis will be performed chromosome wise or not. The default is FALSE.}

\item{r2_LD}{Numeric value, specifying the LD threshold for clumping in LDSC model. The default is 0.}

\item{LDSC_blocks}{Integer value, specifying the block size for performing jackknife variance estimator in LDSC model following (3). The default is 200.}

\item{REMLalgo}{Integer value of 0, 1 or 2, specifying the algorithm to run REML iterations, 0 for average information (AI), 1 for Fisher-scoring and 2 for EM. The default option is 0, i.e. AI-REML (1).}

\item{nitr}{Integer value, specifying the number of iterations for performing the REML. The default is 100.}

\item{cat_covarfile}{A character string, specifying the name of the categorical covariate file which is a plain text file with no header line; columns are family ID, individual ID and discrete covariates. The default is NULL. This file needs to be in DataDir.}

\item{quant_covarfile}{A character string, specifying the name of the quantitative covariate file which is a plain text file with no header line; columns are family ID, individual ID and continuous covariates. The default is NULL. This file needs to be in DataDir.}

\item{prevalance}{Numeric value, specifying the disease prevalence. The default is 0.01.}

\item{partGRM}{Boolean value, 'TRUE' or 'FALSE', specifying whether the GRM will be partitioned into n parts (by row) in GREML model. The default is FALSE.}

\item{autosome}{Boolean value, 'TRUE' or 'FALSE', specifying whether estimate of heritability will be done for autosomes or not. The default is ‘TRUE’.}

\item{Xsome}{Boolean value, 'TRUE' or 'FALSE', specifying whether estimate of heritability will be done for X chromosome or not. The default is ‘TRUE’.}

\item{nGRM}{Integer value, specifying the number of the partision of the GRM in GREML model. The default is 3.}

\item{cripticut}{Numeric value, specifying the threshold to create a new GRM of "unrelated" individuals in GREML model. The default is arbitrary chosen as 0.025 following (1).}

\item{minMAF}{Positive numeric value (< maxMAF), specifying the minimum threshold for the MAF filter of the SNPs in the GREML model.}

\item{maxMAF}{Positive numeric value (minMAF,1), specifying the maximum threshold for the MAF filter of the SNPs in the GREML model.}

\item{hg}{Boolean value, specifying the genome built, “hg19” or “hg38” to use chromosome length from UCSC genome browser and getting genes and proteins according to this built. The default is “hg19”.}

\item{PlotIndepSNP}{Boolean value, 'TRUE' or 'FALSE', specifying whether to use independent SNPs i.e., chromosome-wise LD pruned SNPs in the plots or not. The default is TRUE.}

\item{IndepSNP_window_size}{Integer value, specifying a window size in variant count or kilobase for LD-based filtering. The default is 50.}

\item{IndepSNP_step_size}{Integer value, specifying a variant count to shift the window at the end of each step for LD filtering for pruned SNPs in the plots. The default is 5.}

\item{IndepSNP_r2_threshold}{Numeric value between 0 to 1 of pairwise r^2 threshold for LD-based filtering for pruned SNPs in the plots. The default is 0.02.}

\item{highLD_regions}{Character string, specifying the .txt file name with genomic regions with high LD for using in finding pruned SNPs in the plots. This file needs to be in DataDir.}
}
\value{
A dataframe with eight columns for GREML and ten columns for LDSC model if byCHR is TRUE. The columns, such as, "chromosome"(i.e., chromosome code),"snp_proportion" (i.e.,chromosome-wise SNP propotion)", "no.of.genes" (i.e., number of genes per chromosome), "no.of.proteins" (i.e., number of genes per chromosome),"size_mb" (i.e., chromosome length), "Source" (i.e., source of heritability), "Variance" (i.e., estimated heritability), and "SE" (i.e., standard error of the estimated heritability) are common for both GREML and LDSC model. The column, "Intercept" (i.e., LDSC regression intercept) and "Int_SE" (i.e., standard error of the intercept) will be two extra columns for LDSC models. Source column will have rows, such as V(1) (i.e., name of genetic variance), V(e) (i.e., residual variance), V(p) (i.e., phenotypic variance), V(1)/Vp (i.e., ratio of genetic variance to phenotypic variance), and V(1)/Vp_L (i.e., ratio of genetic variance to phenotypic variance in liability scale for binary phenotypes). If byCHR is FALSE, then the first five columns will not be reported in the dataframe.
}
\description{
This functions performs two types of heritability estimation, (i)GREML:Genomic relatedness matrix (GRM) restricted maximum likelihood-based method following GCTA (1) and (ii)LDSC: LD score regression-based method following (2,3). For the details, please follow the associated paper.

Prior using this function, users are recommended to apply QCsnp and QCsample to ensure data quality control.
}
\examples{
#Not Run
}
\references{
(1)	Yang et al. (2011) GCTA: a tool for Genome-wide Complex Trait Analysis. Am J Hum Genet. 88(1): 76-82.
(2)	Bulik-Sullivan B, et al. LD score regression distinguishes confounding from polygenicity in genome-wide association studies. Nat Genet. 2014;47:291–295.
(3)	Florian Privé, Julyan Arbel, Bjarni J Vilhjálmsson, LDpred2: better, faster, stronger, Bioinformatics, Volume 36, Issue 22-23, 1 December 2020, Pages 5424–5431, https://doi.org/10.1093/bioinformatics/btaa1029
}
