% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GXwasR_main_functions.R
\name{MetaGWAS}
\alias{MetaGWAS}
\title{MetaGWAS: Combining summary-level results from two or more GWA studies into a single estimate.}
\usage{
MetaGWAS(
  DataDir,
  SummData = c(""),
  ResultDir = tempdir(),
  SNPfile = NULL,
  useSNPposition = TRUE,
  UseA1 = FALSE,
  GCse = TRUE,
  plotname = "Meta_Analysis.plot",
  pval_filter = "R",
  top_snp_pval = 1e-08,
  max_top_snps = 6,
  chosen_snps_file = NULL,
  byCHR = FALSE,
  pval_threshold_manplot = 1e-05
)
}
\arguments{
\item{DataDir}{A character string for the file path of the input files needed for \code{SummData} and \code{SNPfile} arguments.}

\item{SummData}{Vector value containing the name(s) of the .Rda file(s) with GWAS summary statistics, with ‘SNP’
(i.e., SNP idenitifier), ‘BETA’ (i.e., effect-size or logarithm of odds ratio), ‘SE’ (i.e., standard error of BETA),
‘P’ (i.e., p-values), 'NMISS' (i.e., effective sample size), 'L95' (i.e., lower limit of 95\% confidence interval) and
'U95' (i.e., upper limit of 95\% confidence interval) are in mandatory column headers. These files needed to be in DataDir.
If the numbers of cases and controls are unequal, effective sample size should be \eqn{4 / (1/<# of cases> + 1/<# of controls>)}.
A smaller "effective" sample size may be used for samples that include related individuals, however simulations indicate
that small changes in the effective sample size have relatively little effect on the final p-value
\insertCite{Willer2010}{GXwasR}. Columns, such as, \code{CHR} (Chromosome code), \code{BP} (Basepair position), \code{A1} (First allele code),
\code{A2} (Second allele code) columns are optional. If these are present, setting \code{useSNPposition} to \code{FALSE}, causes \code{CHR}, \code{BP}
and \code{A1} to be ignored and setting \code{UseA1} to be \code{FALSE} causes \code{A1} to be ignored. If, both these arguments are \code{TRUE}, this
function takes care of A1/A2 allele flips properly. Otherwise, A1 mismatches are thrown out. Values of CHR/BP are allowed
to vary.}

\item{ResultDir}{A character string for the file path where all output files will be stored. The default is \code{tempdir()}.}

\item{SNPfile}{Character string specifying the name of the plain-text file with a column of SNP names. These could be LD clumped SNPs or
any other list of chosen SNPs for Meta analysis. This file needs to be in \code{DataDir}.}

\item{useSNPposition}{Boolean value, \code{TRUE} or \code{FALSE} for using \code{CHR}, \code{BP}, and \code{A1} or not. The default is \code{FALSE.} Note: if
this is \code{FALSE} then there will be no Manhattan and QQ plot will be generated.}

\item{UseA1}{Boolean value, \code{TRUE} or \code{FALSE} for \code{A1} to be used or not. The default is \code{FALSE}.}

\item{GCse}{Boolean value, \code{TRUE} or \code{FALSE} for applying study specific genomic control to adjust each study for potential population
structure for all the SNPs. The default is \code{TRUE}. If users would want to apply genomic control separately for directly
genotyped and imputed SNPs prior using the function, set this parameter as \code{FALSE}.}

\item{plotname}{Character string, spycifying the plot name of the file containg forest plots for the SNPs. The default is
“Meta_Analysis.plot”.}

\item{pval_filter}{Character value as "R","F" or "W", specifying whether p-value threshold should be chosen based on “Random”, “Fixed” or
“Weighted” effect model for the SNPs to be included in the forest plots.}

\item{top_snp_pval}{Numeric value, specifying the threshold to be used to filter the SNPs for the forest plots. The default is 1e-08.}

\item{max_top_snps}{Integer value, specifying the maximum number of top SNPs (SNPs with the lowest p-values) to be ploted in the forest
plot file. The default is 6.}

\item{chosen_snps_file}{Character string specifing the name of the plain-text file with a column of SNP names for the forest plots.
The default is NULL.}

\item{byCHR}{Boolean value, \code{TRUE} or \code{FALSE}, specifying whether the meta analysis will be performed chromosome wise or not.
The default is \code{FALSE}.}

\item{pval_threshold_manplot}{Numeric value, specifying the p-value threshold for plotting Manhattan plots.}
}
\value{
A list object containing five dataframes. The first three dataframes, such as Mfixed, Mrandom and Mweighted contain results
for fixed effect, random effect and weighted model. Each of these dataframes can have maximum 12 columns, such as:
\itemize{
\item \code{CHR} (Chromosome code)
\item \code{BP} (Basepair position)
\item \code{SNP} (SNP identifier)
\item \code{A1} (First allele code)
\item \code{A2} (Second allele code)
\item \code{Q} (p-value for Cochrane's Q statistic)
\item \code{I} (I^2 heterogeneity index (0-100))
\item \code{P} (P-value from mata analysis)
\item \code{ES} (Effect-size estimate from mata analysis)
\item \code{SE} (Standard Error from mata analysis)
\item \code{CI_L} (Lower limit of confidence interval)
\item \code{CI_U} (Uper limit of confidence interval)
}

The fourth dataframe contains the same columns \code{CHR}, \code{BP}, \code{SNP}, \code{A1}, \code{A2}, \code{Q}, \code{I}", with column \code{N}' ( Number of
valid studies for this SNP), P (Fixed-effects meta-analysis p-value), and other columns as \code{Fx...} (Study x (0-based input file
indices) effect estimate, Examples: F0, F1 etc.).

The fifth dataframe, ProblemSNP has three columns, such as
\itemize{
\item \code{File} (file name of input data),
\item \code{SNP} (Problematic SNPs that are thrown)
\item \code{Problem} (Problem code)
}

Problem codes are:
\itemize{
\item BAD_CHR (Invalid chromosome code)
\item BAD_BP  (Invalid base-position code), BAD_ES (Invalid effect-size)
\item BAD_SE (Invalid standard error), MISSING_A1 (Missing allele 1 label)
\item MISSING_A2 (Missing allele 2 label)
\item ALLELE_MISMATCH (Mismatching allele codes across files)
}

A .pdf file comprising the forest plots of the SNPs is produced in the ResultDir with Plotname as prefix.
If \code{useSNPposition} is set \code{TRUE}, a .jpeg file with Manhattan Plot and Q-Q plot will be in the \code{ResultDir} with Plotname
as prefix.
}
\description{
This function combine K sets of GWAS association statistics on same (or at least similar) phenotype. This function employs
PLINK's \insertCite{Purcell2007}{GXwasR} inverse variance-based analysis to run a number of models, including a)
Fixed-effect model and b) Random-effect model, assuming there may be variation between the genuine underlying effects,
i.e., effect size beta. 'This function also calculates weighted Z-score-based p-values after METAL \insertCite{Willer2010}{GXwasR}.
For more information about the algorithms, please see the associated paper.
}
\examples{
DataDir <- system.file("extdata", package = "GXwasR")
ResultDir <- tempdir()
data("GXwasRData")
SummData <- list(Summary_Stat_Ex1, Summary_Stat_Ex2)
SNPfile <- "UniqueLoci"
useSNPposition <- FALSE
UseA1 <- TRUE
GCse <- TRUE
byCHR <- FALSE
pval_filter <- "R"
top_snp_pval <- 1e-08
max_top_snps <- 10
chosen_snps_file <- NULL
pval_threshold_manplot <- 1e-05
plotname <- "Meta_Analysis.plot"
x <- MetaGWAS(
  DataDir = DataDir, SummData = SummData, ResultDir = ResultDir,
  SNPfile = NULL, useSNPposition = TRUE, UseA1 = UseA1, GCse = GCse,
  plotname = "Meta_Analysis.plot", pval_filter, top_snp_pval, max_top_snps,
  chosen_snps_file = NULL, byCHR, pval_threshold_manplot
)
}
\references{
\insertAllCited{}
}
